<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1122.52, initial-scale=1.0, user-scalable=no">
    <title>cms-report</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" as="style" crossorigin>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css');
    </style>
    <!-- Chart.js 라이브러리 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body data-kakao-app-key="{{카카오맵API키}}">
    <div class="page-wrapper">
        <!-- 기존의 <section class="page"> 들이 이 안에 들어갑니다 -->
    <!-- 페이지 1: 표지 (페이지 번호 없음) -->
    <section class="page page-cover">
        <div class="container">
            <div class="header-frame">
                <div class="title-section">
                    <h1 class="main-title">Dooh Service 효과 분석 보고서</h1>
                    <h2 class="contract-name">{{스케줄명}}</h2>
                </div>
                <div class="icon-group">
                    <img src="icon-group.png" alt="ADeX 아이콘" class="icon-image">
                </div>
            </div>
            
            <div class="footer-frame">
                <div class="info-section">
                    <div class="period-row">
                        <span class="label">광고기간 : </span>
                        <span class="date-range">
                            <span class="date">{{광고시작일}}</span>
                            <span class="separator">~</span>
                            <span class="date">{{광고종료일}}</span>
                        </span>
                        <span class="total-days">
                            <span class="parenthesis">(총</span>
                            <span class="days-number">{{운영일수}}</span>
                            <span class="days-unit">일)</span>
                        </span>
                    </div>
                    <div class="advertiser-row">
                        <span class="label">광고주명 :</span>
                        <span class="advertiser-name">{{광고주명}}</span>
                    </div>
                </div>
                <div class="issue-date">{{보고서발행일}} 발행</div>
            </div>
        </div>
    </section>

    <!-- 페이지 2: 목차 -->
    <section class="page">
        <div class="container">
            <!-- 상단 헤더 -->
            <div class="toc-header">
                <!-- Breadcrumb 그룹 -->
                <div class="breadcrumb-group">
                    <span class="text-스케줄명">{{스케줄명}}</span>
                    <span class="text-separator">|</span>
                    <span class="text-목차">목차</span>
                </div>
                <!-- 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                <div class="text-platform">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
            </div>

            <!-- 내용 영역: 목차 카드 -->
            <div class="frame-내용영역">
                <!-- 목차 영역: 내부 컨테이너 -->
                <div class="frame-목차영역">
                    <!-- 타이틀-목차: 목차 제목 프레임 -->
                    <div class="frame-타이틀목차">
                        <h2 class="text-toc-title">목차</h2>
                    </div>
                    <!-- 목차 리스트: 섹션 컨테이너 -->
                    <div class="frame-목차리스트">
                        <h3 class="text-section-title">1. 미디어그룹 및 주요 광고 성과</h3>
                        <!-- 2. 미디어그룹별 광고 효과 분석: 서브섹션 -->
                        <div class="frame-미디어그룹별광고효과분석">
                            <h4 class="text-subsection-title">2. 미디어그룹별 효과 분석</h4>
                            <ol class="text-subsection-content media-group-list">
                                <!-- 미디어그룹 리스트는 서버에서 반복문으로 동적 생성 -->
                                <!-- 정렬 규칙: 유동 대비 노출 비율순으로 정렬 (내림차순), 동일한 비율일 경우 ㄱㄴㄷ, a-z 순으로 정렬 -->
                                <!-- 
                                    예시 정렬 로직 (JavaScript):
                                    미디어그룹리스트.sort((a, b) => {
                                        // 1순위: 유동 대비 노출 비율 (내림차순)
                                        const ratioA = (a.ots / a.circulation) * 100;
                                        const ratioB = (b.ots / b.circulation) * 100;
                                        if (ratioB !== ratioA) {
                                            return ratioB - ratioA; // 내림차순
                                        }
                                        // 2순위: 동일 비율일 경우 이름순 (ㄱㄴㄷ, a-z)
                                        return a.이름.localeCompare(b.이름, 'ko');
                                    });
                                    
                                    예시 정렬 로직 (Python):
                                    sorted(미디어그룹리스트, key=lambda x: (-(x.ots / x.circulation * 100), x.이름))
                                -->
                                <!-- Handlebars: {{#each (sortByRatio 미디어그룹리스트)}}<li>{{this.이름}}</li>{{/each}} -->
                                <!-- Jinja2: {% for item in 미디어그룹리스트|sort(attribute='노출비율', reverse=True)|sort(attribute='이름') %}<li>{{item.이름}}</li>{% endfor %} -->
                                <!-- 현재는 임시로 하나의 항목으로 표시 (서버에서 동적 생성 필요) -->
                                <li>{{미디어그룹리스트}}</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 효과 분석 안내: 하단 안내 박스 -->
            <div class="frame-효과분석안내">
                <!-- 정보 박스 헤더 -->
                <div class="info-box-header">
                    <img src="icon1.svg" alt="아이콘" class="frame-icon">
                    <span class="text-info-title">효과 분석 안내</span>
                </div>
                <!-- 내용 텍스트 -->
                <p class="text-info-content">효과 분석은 공공데이터, 통신사 데이터, 모바일 OD, 자체 수집 데이터를 기반으로 한 엠앤엠네트웍스의 알고리즘 기반 AI 효과 지표 분석 결과입니다. 
                    <br>본 분석은 옥외광고표준화 얼라이언스 가이드를 준수합니다.</p>
            </div>
            
            <!-- 페이지 번호: container 기준 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 3: 간지 1 -->
    <section class="page page-divider">
        <div class="container container-divider">
            <div class="divider-content">
                <h1 class="divider-title">1. 미디어그룹 및 주요 광고 성과</h1>
                <div class="divider-logo">
                    <img src="logo-black.png" alt="ADeX 로고" class="logo-image">
                </div>
            </div>
            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 4: 미디어그룹 정보 -->
    <section class="page page-media-info page-performance-2">
        <div class="container container-media-info">
            <!-- head: 헤더 영역 (Frame 10) -->
            <div class="frame-head">
                <!-- top title: 상단 Breadcrumb -->
                <div class="frame-top-title">
                    <!-- top title: Breadcrumb 그룹 -->
                    <div class="frame-top-title-group">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹 및 주요 광고 성과</span>
                    </div>
                    <!-- adex: 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                    <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
                </div>
                <!-- sub title: 타이틀 영역 -->
                <div class="frame-sub-title">
                    <h1 class="text-media-title">미디어그룹 정보</h1>
                    <p class="text-media-subtitle">미디어그룹 및 광고 기간에 대한 정보</p>
                </div>
            </div>

            <!-- 콘텐츠 래퍼 -->
            <div class="content-wrapper">
                <!-- 내용: 본문 영역 (Frame 내용) -->
                <div class="frame-내용">
                    <!-- content title: 광고 정보 헤더 -->
                    <div class="frame-content-title">
                        <h2 class="text-ad-info-title">광고 정보</h2>
                    </div>

                    <!-- table: 테이블 영역 (Frame table) -->
                    <div class="table-frame frame-table-container">
                        <table class="frame-table">
                        <!-- 첫 번째 행 -->
                        <tr class="table-row-first">
                            <td class="field field-label">
                                <span class="field-text">광고주</span>
                            </td>
                            <td class="field field-value" colspan="1">
                                <span class="field-text">{{광고주명}}</span>
                            </td>
                            <td class="field field-label">
                                <span class="field-text">광고 계약명</span>
                            </td>
                            <td class="field field-value" colspan="1">
                                <span class="field-text">{{스케줄명}}</span>
                            </td>
                        </tr>

                        <!-- 두 번째 행 (동적 항목 반복 가능) -->
                        <!-- 서버에서 미디어그룹과 미디어 정보를 반복문으로 생성 -->
                        <!-- 예시: {{#each 미디어그룹리스트}} 또는 {% for item in 미디어그룹리스트 %} -->
                        <tr class="table-row-middle">
                            <td class="field field-label field-tall">
                                <span class="field-text">미디어그룹</span>
                            </td>
                            <!-- Frame 16: 미디어그룹 값 그룹 -->
                            <td class="field field-value field-tall">
                                <!-- 동적 항목: 서버에서 반복문으로 생성 -->
                                <!-- 예시: {{#each 미디어그룹리스트}} -->
                                <!--   <div class="field-value-item">{{this}}</div> -->
                                <!-- {{/each}} -->
                                <div class="field-value-item">{{미디어그룹_1}}</div>
                                <div class="field-value-item">{{미디어그룹_2}}</div>
                                <div class="field-value-item">{{미디어그룹_3}}</div>
                            </td>
                            <td class="field field-label field-tall">
                                <div class="field-label-content">
                                    <span class="field-text">미디어 정보</span>
                                    <span class="field-text-small">(유형 / 사이즈 / *간격/ 대수)</span>
                                </div>
                            </td>
                            <!-- Frame 17: 미디어 정보 값 그룹 -->
                            <td class="field field-value field-tall">
                                <!-- 동적 항목: 서버에서 반복문으로 생성 -->
                                <!-- 미디어 정보 구조: -->
                                <!-- 1. LCD: LCD/ n "/ N대 (n은 사이즈 인치, N은 동일한 사이즈의 LCD 대 수) -->
                                <!--    예시: LCD/ 55 "/ 10대 -->
                                <!-- 2. LED: LED/ 세로 x 가로 mm/ 간격 mm/ N대 (N은 동일한 세로 x 가로, 간격의 LED 대 수) -->
                                <!--    예시: LED/ 1920 x 1080 mm/ 50 mm/ 5대 -->
                                <!-- 3. 기타: 기타/ 세로 x 가로 mm/ N대 (N은 동일한 세로 x 가로의 기타 디스플레이 대 수) -->
                                <!--    예시: 기타/ 800 x 600 mm/ 3대 -->
                                <!-- 
                                    서버 측 렌더링 예시:
                                    {{#each 미디어정보리스트}}
                                      <div class="field-value-item">
                                        {{#if (eq this.유형 "LCD")}}
                                          LCD/ {{this.사이즈}} "/ {{this.대수}}대
                                        {{else if (eq this.유형 "LED")}}
                                          LED/ {{this.세로}} x {{this.가로}} mm/ {{this.간격}} mm/ {{this.대수}}대
                                        {{else}}
                                          기타/ {{this.세로}} x {{this.가로}} mm/ {{this.대수}}대
                                        {{/if}}
                                      </div>
                                    {{/each}}
                                -->
                                <div class="field-value-item">{{미디어정보_1}}</div>
                                <div class="field-value-item">{{미디어정보_2}}</div>
                                <div class="field-value-item">{{미디어정보_3}}</div>
                            </td>
                        </tr>

                        <!-- 세 번째 행 -->
                        <tr class="table-row-last">
                            <td class="field field-label">
                                <span class="field-text">광고 기간</span>
                            </td>
                            <td class="field field-value field-bg-light" colspan="1">
                                <span class="field-text">{{광고시작일}} ~ {{광고종료일}} (총 {{운영일수}}일)</span>
                            </td>
                            <td class="field field-label">
                                <span class="field-text">보고서 발행일</span>
                            </td>
                            <td class="field field-value field-bg-light" colspan="1">
                                <span class="field-text">{{보고서발행일}}</span>
                            </td>
                        </tr>
                        </table>
                    </div>

                    <!-- pitch 안내 문구: 주석 -->
                    <p class="text-pitch-note">※ 간격은 LED 미디어에 한해 기입됩니다.</p>
                </div>
            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 5: 주요 광고 성과 - Ⅰ -->
    <section class="page page-media-info">
        <div class="container container-media-info">
            <!-- head: 헤더 영역 -->
            <div class="frame-head">
                <!-- top title: 상단 Breadcrumb -->
                <div class="frame-top-title">
                    <!-- top title: Breadcrumb 그룹 -->
                    <div class="frame-top-title-group">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹 및 주요 광고 성과</span>
                    </div>
                    <!-- adex: 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                    <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
                </div>
                <!-- sub title: 타이틀 영역 -->
                <div class="frame-sub-title">
                    <h1 class="text-media-title">주요 광고 성과 - Ⅰ</h1>
                    <p class="text-media-subtitle">광고 기간 동안 수집된 데이터 기반 미디어그룹 효과 지표</p>
                </div>
            </div>

            <!-- contents: 본문 영역 (Frame contents) -->
            <div class="frame-contents">
                <!-- circulation/ots: Frame circulation/ots -->
                <div class="frame-circulation-ots">
                    <!-- content title: circulation / ots 헤더 -->
                    <div class="frame-content-title">
                        <h2 class="text-ad-info-title">유동인구 / 노출인구</h2>
                        <!-- 데이터 분석 정보 -->
                        <div class="frame-data-info">
                            <span class="data-info-text">수집 기간: {{광고시작일}} ~ {{광고종료일}} | 산출 기준: 전체 미디어그룹의 유동인구・노출인구 총합</span>
                        </div>
                    </div>

                    <!-- table: circulation/ots 테이블 -->
                    <div class="table-frame frame-table-performance-container">
                        <table class="frame-table frame-table-performance">
                        <tr class="table-row-first">
                            <td class="field field-label">
                                <span class="field-text">유동인구</span>
                            </td>
                            <td class="field field-value">
                                <span class="field-text">{{circulation}}명</span>
                            </td>
                            <td class="field field-label">
                                <span class="field-text">노출인구</span>
                            </td>
                            <td class="field field-value">
                                <span class="field-text">{{ots}}명</span>
                            </td>
                        </tr>
                        </table>
                    </div>

                    <!-- insight: 인사이트 박스 -->
                    <div class="frame-insight">
                        <!-- Auto awesome: 아이콘 -->
                        <img src="insight icon.svg" alt="인사이트 아이콘" class="insight-icon">
                        <!-- Frame 1686563118: 인사이트 텍스트 컨테이너 -->
                        <div class="frame-insight-text-container">
                                <span>유동 대비 노출 비율은 </span>
                                <!-- Frame 1686563120: 비율 텍스트 -->
                                <span class="frame-insight-ratio-text">
                                    <span class="insight-value">{{노출비율}}%</span>
                                    <span>로 </span>
                                </span>
                                <!-- Frame 1686563119: 효과 수준 텍스트 -->
                                <span class="frame-insight-effect-level">
                                    <span class="insight-highlight">{{광고효과수준}} 수준의 효과</span>
                                    <span>를 보였습니다.</span>
                                </span>
                        </div>
                    </div>
                </div>

                <!-- Frame 21: 주요 오디언스 요약 -->
                <div class="frame-audience-summary">
                    <!-- content title: 주요 오디언스 요약 헤더 -->
                    <div class="frame-content-title">
                        <h2 class="text-ad-info-title">주요 오디언스 요약</h2>
                        <!-- 데이터 분석 정보 -->
                        <div class="frame-data-info">
                            <span class="data-info-text">수집 기간: {{광고시작일}} ~ {{광고종료일}} | 산출 기준: 전체 미디어그룹의 노출인구 총합, 미디어그룹별 노출인구 총합</span>
                        </div>
                    </div>

                    <!-- Frame 23: 인사이트 컨테이너 -->
                    <div class="frame-insight-container">
                        <!-- insight: 인사이트 박스 -->
                        <div class="frame-insight frame-insight-large">
                            <!-- Frame 24: 아이콘 + 텍스트 컨테이너 -->
                            <div class="frame-insight-header">
                                <!-- Auto awesome: 아이콘 -->
                                <img src="insight icon.svg" alt="인사이트 아이콘" class="insight-icon">
                                <!-- Frame 1686563123: 다중 줄 텍스트 컨테이너 -->
                                <div class="frame-insight-multiline">
                                    <!-- Frame 1686563118: 첫 번째 줄 -->
                                    <div class="frame-insight-text-container">
                                        <span>주요 오디언스 </span>
                                        <span class="insight-highlight">1위는 </span>
                                        <!-- Frame 1686563120: 1위 정보 -->
                                        <span class="frame-insight-rank-1">
                                            <span class="insight-highlight">{{오디언스1위}}</span>
                                            <span class="insight-highlight">({{오디언스1위비율}}%), </span>
                                        </span>
                                        <span class="insight-highlight">2위는 </span>
                                        <!-- Frame 1686563121: 2위 정보 -->
                                        <span class="frame-insight-rank-2">
                                            <span class="insight-highlight">{{오디언스2위}}</span>
                                            <span class="insight-highlight">({{오디언스2위비율}}%), </span>
                                        </span>
                                        <span class="insight-highlight">3위는 </span>
                                        <!-- Frame 1686563122: 3위 정보 -->
                                        <span class="frame-insight-rank-3">
                                            <span class="insight-highlight">{{오디언스3위}}</span>
                                            <span class="insight-highlight">({{오디언스3위비율}}%)</span>
                                        </span>
                                        <span>입니다.</span>
                                    </div>
                                    <!-- Frame 1686563119: 두 번째 줄 -->
                                    <div class="frame-insight-effect-level">
                                        <!-- Frame 1686563120: 오디언스 정보 -->
                                        <span class="frame-insight-audience-info">
                                            <span class="frame-insight-rank-3">
                                                <span class="insight-highlight">{{오디언스1위}}</span>
                                                <span>이 가장 많은 미디어그룹은 </span>
                                            </span>
                                        </span>
                                        <span class="insight-highlight">{{최다미디어그룹}}</span>
                                        <span>입니다.</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Frame 22: 노출인구 최다 미디어그룹 -->
                <div class="frame-max-exposure-group">
                    <!-- content title: 노출인구 최다 미디어그룹 헤더 -->
                    <div class="frame-content-title">
                        <h2 class="text-ad-info-title">노출인구 최다 미디어그룹</h2>
                        <!-- 데이터 분석 정보 -->
                        <div class="frame-data-info">
                            <span class="data-info-text">수집 기간: {{광고시작일}} ~ {{광고종료일}} | 산출 기준: 미디어그룹별 노출인구 총합</span>
                        </div>
                    </div>

                    <!-- insight: 인사이트 박스 (Frame 22 안에 직접 위치) -->
                    <div class="frame-insight">
                        <!-- Frame 24: 아이콘 + 텍스트 컨테이너 -->
                        <div class="frame-insight-header">
                            <!-- Auto awesome: 아이콘 -->
                            <img src="insight icon.svg" alt="인사이트 아이콘" class="insight-icon">
                            <!-- Frame 1686563118: 인사이트 텍스트 -->
                            <div class="frame-insight-text-container">
                                <span>노출인구가 가장 많은 미디어그룹은 </span>
                                <!-- Frame 1686563120: 미디어그룹 정보 -->
                                <span class="frame-insight-media-group-info">
                                    <span class="insight-highlight">{{최다미디어그룹}}</span>
                                    <span>이며, 노출인구 수는 </span>
                                </span>
                                <!-- Frame 1686563121: ots 수 정보 -->
                                <span class="frame-insight-ots-count">
                                    <span class="insight-highlight">{{최다ots수}}명</span>
                                    <span>입니다.</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 6: 주요 광고 성과 - Ⅱ -->
    <section class="page page-media-info">
        <div class="container container-media-info">
            <!-- head: 헤더 영역 (Frame 10) -->
            <div class="frame-head">
                <!-- top title: 상단 Breadcrumb -->
                <div class="frame-top-title">
                    <!-- top title: Breadcrumb 그룹 -->
                    <div class="frame-top-title-group">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹 및 주요 광고 성과</span>
                    </div>
                    <!-- adex: 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                    <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
                </div>
                <!-- sub title: 타이틀 영역 (Frame 9) -->
                <div class="frame-sub-title">
                    <h1 class="text-media-title">주요 광고 성과 - Ⅱ</h1>
                </div>
            </div>

            <!-- 주요 광고 성과2 차트 섹션 -->
            <div class="performance-chart-section">
                <!-- content title -->
                <div class="frame-content-title">
                    <h2 class="text-ad-info-title">미디어그룹별 유동인구와 노출인구</h2>
                        <!-- 데이터 분석 정보 -->
                        <div class="frame-data-info">
                            <span class="data-info-text">수집 기간: {{광고시작일}} ~ {{광고종료일}} | 산출 기준: 미디어그룹별 유동인구・노출인구 총합</span>
                        </div>
                </div>

                <!-- 차트 영역 -->
                <div class="frame-chart-area">
                    <canvas id="chart-canvas-media-group-population"></canvas>
                </div>
            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 7: 주요 광고 성과 - Ⅲ -->
    <section class="page page-media-info page-performance-3">
        <div class="container container-media-info">
            <!-- head: 헤더 영역 (Frame 10) -->
            <div class="frame-head">
                <!-- top title: 상단 Breadcrumb -->
                <div class="frame-top-title">
                    <!-- top title: Breadcrumb 그룹 -->
                    <div class="frame-top-title-group">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹 및 주요 광고 성과</span>
                    </div>
                    <!-- adex: 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                    <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
                </div>
                <!-- sub title: 타이틀 영역 (Frame 9) -->
                <div class="frame-sub-title">
                    <h1 class="text-media-title">주요 광고 성과 - Ⅲ</h1>
                </div>
            </div>

            <!-- 성과 테이블 섹션 -->
            <div class="performance-table-section">
                <!-- 성과 테이블 래퍼 -->
                <div class="performance-table-wrapper">
                    <!-- Frame 21: content title -->
                    <div class="frame-content-title">
                        <h2 class="text-ad-info-title">미디어그룹별 광고 성과</h2>
                        <!-- 데이터 분석 정보 -->
                        <div class="frame-data-info">
                            <span class="data-info-text">수집 기간: {{광고시작일}} ~ {{광고종료일}} | 산출 기준: 유동인구・노출인구 총합</span>
                        </div>
                    </div>

                    <!-- Frame 28: 테이블 -->
                    <div class="table-frame frame-table-performance3-container">
                        <table class="frame-table-performance3">
                        <!-- 테이블 헤더 -->
                        <thead>
                            <tr class="table-header-row">
                                <th class="field field-label">미디어그룹명</th>
                                <th class="field field-label">유동인구</th>
                                <th class="field field-label">노출인구</th>
                                <th class="field field-label">유동인구 대비 노출인구 비율</th>
                                <th class="field field-label">CPM (노출인구 기준)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- 일반 미디어그룹 행들 (서버에서 반복문으로 동적 생성) -->
                            <!-- 미디어그룹 수만큼 행이 동적으로 생성됩니다 -->
                            <!-- 예시: {{#each 미디어그룹리스트}} 또는 {% for item in 미디어그룹리스트 %} -->
                            <!-- 
                                서버 측 렌더링 예시 (Handlebars):
                                {{#each 미디어그룹리스트}}
                                <tr class="table-data-row">
                                    <td class="field field-value">{{this.이름}}</td>
                                    <td class="field field-value">{{this.circulation}}명</td>
                                    <td class="field field-value">{{this.ots}}명</td>
                                    <td class="field field-value">{{this.circulation대비ots비율}}%</td>
                                    <td class="field field-value field-value-currency">{{this.CPM}}원</td>
                                </tr>
                                {{/each}}
                                
                                서버 측 렌더링 예시 (Jinja2):
                                {% for item in 미디어그룹리스트 %}
                                <tr class="table-data-row">
                                    <td class="field field-value">{{item.이름}}</td>
                                    <td class="field field-value">{{item.circulation}}명</td>
                                    <td class="field field-value">{{item.ots}}명</td>
                                    <td class="field field-value">{{item.circulation대비ots비율}}%</td>
                                    <td class="field field-value field-value-currency">{{item.CPM}}원</td>
                                </tr>
                                {% endfor %}
                            -->
                            <!-- 서버에서 미디어그룹 수만큼 반복 생성 -->
                            <!-- Handlebars 예시: {{#each 미디어그룹리스트}} -->
                            <!-- Jinja2 예시: {% for item in 미디어그룹리스트 %} -->
                            <!-- 현재는 임시로 하나의 행으로 표시 (서버에서 동적 생성 필요) -->
                            <!-- 서버 측에서 아래 행을 미디어그룹 수만큼 반복 생성해야 합니다 -->
                            <tr class="table-data-row">
                                <td class="field field-value">{{미디어그룹명}}</td>
                                <td class="field field-value">{{circulation}}명</td>
                                <td class="field field-value">{{ots}}명</td>
                                <td class="field field-value">{{circulation대비ots비율}}%</td>
                                <td class="field field-value field-value-currency">{{CPM}}원</td>
                            </tr>
                        </tbody>
                        </table>
                    </div>

            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

            <!-- 페이지 8: 주요 광고 성과 - Ⅳ (인구 피라미드) -->
    <section class="page page-media-info page-performance-4">
        <div class="container container-media-info">
            <!-- head: 헤더 영역 (Frame 10) -->
            <div class="frame-head">
                <!-- top title: 상단 Breadcrumb -->
                <div class="frame-top-title">
                    <!-- top title: Breadcrumb 그룹 -->
                    <div class="frame-top-title-group">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹 및 주요 광고 성과</span>
                    </div>
                    <!-- adex: 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                    <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
                </div>
                <!-- sub title: 타이틀 영역 (Frame 9) -->
                <div class="frame-sub-title">
                    <h1 class="text-media-title">주요 광고 성과 - Ⅳ</h1>
                </div>
            </div>

            <!-- Performance chart: 연령·성별 비교 -->
            <div class="performance-chart-container performance-chart-age-gender-section">
                <!-- Frame 20: 차트 영역 -->
                <div class="frame-chart-age-gender">
                    <!-- Frame 21: content title -->
                    <div class="frame-content-title">
                        <h2 class="text-ad-info-title">노출인구 연령・성별 분포 비교</h2>
                        <!-- 데이터 분석 정보 -->
                        <div class="frame-data-info">
                            <span class="data-info-text">수집 기간: {{광고시작일}} ~ {{광고종료일}} | 산출 기준: 미디어그룹별 노출인구 총합</span>
                        </div>
                    </div>

                    <!-- 차트 -->
                    <canvas id="chart-canvas-performance4-1"></canvas>
                </div>
            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 9: 주요 광고 성과 - Ⅳ-2 (일별 노출인구 비교) -->
    <section class="page page-media-info page-performance-4-2">
        <div class="container container-media-info">
            <!-- head: 헤더 영역 (Frame 10) -->
            <div class="frame-head">
                <!-- top title: 상단 Breadcrumb -->
                <div class="frame-top-title">
                    <!-- top title: Breadcrumb 그룹 -->
                    <div class="frame-top-title-group">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹 및 주요 광고 성과</span>
                    </div>
                    <!-- adex: 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                    <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
                </div>
                <!-- sub title: 타이틀 영역 (Frame 9) -->
                <div class="frame-sub-title">
                    <h1 class="text-media-title">주요 광고 성과 - Ⅳ</h1>
                </div>
            </div>

            <!-- Performance chart: 일별 비교 -->
            <div class="performance-chart-container performance-chart-daily-section">
                <!-- Frame 20: 차트 영역 -->
                <div class="frame-chart-daily">
                    <!-- Frame 21: content title -->
                    <div class="frame-content-title">
                        <h2 class="text-ad-info-title">일별 노출인구 비교</h2>
                        <!-- 데이터 분석 정보 -->
                        <div class="frame-data-info">
                            <span class="data-info-text">수집 기간: {{광고시작일}} ~ {{광고종료일}} | 산출 기준: 미디어그룹별 일별 노출인구</span>
                        </div>
                    </div>

                    <!-- 차트 -->
                    <canvas id="chart-canvas-daily"></canvas>
                </div>
            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 10: 주요 광고 성과 - Ⅳ-3 (요일별 노출인구 비교) -->
    <section class="page page-media-info page-performance-4-3">
        <div class="container container-media-info">
            <!-- head: 헤더 영역 (Frame 10) -->
            <div class="frame-head">
                <!-- top title: 상단 Breadcrumb -->
                <div class="frame-top-title">
                    <!-- top title: Breadcrumb 그룹 -->
                    <div class="frame-top-title-group">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹 및 주요 광고 성과</span>
                    </div>
                    <!-- adex: 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                    <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
                </div>
                <!-- sub title: 타이틀 영역 (Frame 9) -->
                <div class="frame-sub-title">
                    <h1 class="text-media-title">주요 광고 성과 - Ⅳ</h1>
                </div>
            </div>

            <!-- Performance chart: 요일별 비교 -->
            <div class="performance-chart-container performance-chart-weekly-section">
                <!-- Frame 20: 차트 영역 -->
                <div class="frame-chart-weekly">
                    <!-- Frame 21: content title -->
                    <div class="frame-content-title">
                        <h2 class="text-ad-info-title">요일별 노출인구 비교</h2>
                        <!-- 데이터 분석 정보 -->
                        <div class="frame-data-info">
                            <span class="data-info-text">수집 기간: {{광고시작일}} ~ {{광고종료일}} | 산출 기준: 미디어그룹별 요일별 일 평균 노출인구</span>
                        </div>
                    </div>

                    <!-- 총합이 가장 많은 요일의 값 표시 -->
                    <div class="weekly-chart-max-value" id="weekly-chart-max-value"></div>
                    
                    <!-- 차트 -->
                    <canvas id="chart-canvas-weekly"></canvas>

                    <!-- Container: 범례 영역 -->
                    <div class="weekly-chart-legend">
                        <!-- 범례가 동적으로 생성됩니다 -->
                    </div>
                </div>
            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 11: 주요 광고 성과 - Ⅳ-4 (시간대별 노출인구 비교) -->
    <section class="page page-media-info page-performance-4-4">
        <div class="container container-media-info">
            <!-- head: 헤더 영역 (Frame 10) -->
            <div class="frame-head">
                <!-- top title: 상단 Breadcrumb -->
                <div class="frame-top-title">
                    <!-- top title: Breadcrumb 그룹 -->
                    <div class="frame-top-title-group">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹 및 주요 광고 성과</span>
                    </div>
                    <!-- adex: 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                    <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
                </div>
                <!-- sub title: 타이틀 영역 (Frame 9) -->
                <div class="frame-sub-title">
                    <h1 class="text-media-title">주요 광고 성과 - Ⅳ</h1>
                </div>
            </div>

            <!-- Performance chart: 시간대별 비교 -->
            <div class="performance-chart-container performance-chart-hourly-section">
                <!-- Frame 20: 차트 영역 -->
                <div class="frame-chart-hourly">
                    <!-- Frame 21: content title -->
                    <div class="frame-content-title">
                        <h2 class="text-ad-info-title">시간대별 노출인구 비교</h2>
                        <!-- 데이터 분석 정보 -->
                        <div class="frame-data-info">
                            <span class="data-info-text">수집 기간: {{광고시작일}} ~ {{광고종료일}}, 09시 ~ 22시 | 산출 기준: 미디어그룹별 시간대별 평균 노출인구</span>
                        </div>
                    </div>

                    <!-- Frame 차트 영역 -->
                        <div class="hourly-chart-wrapper">
                        <!-- 총합이 가장 많은 시간대의 값 표시 -->
                        <div class="hourly-chart-max-value" id="hourly-chart-max-value"></div>
                        
                        <!-- 차트 -->
                        <canvas id="chart-canvas-hourly"></canvas>

                        <!-- Container: 범례 영역 -->
                        <div class="hourly-chart-legend">
                            <!-- 범례가 동적으로 생성됩니다 -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 12: 간지 2 (미디어그룹별 효과 분석) -->
    <section class="page page-divider">
        <div class="container container-divider">
            <div class="divider-content">
                <h1 class="divider-title">2. 미디어그룹별 효과 분석</h1>
                <!-- 분석 미디어그룹 목록 컨테이너 -->
                <div class="divider-media-group-container">
                    <!-- 분석 미디어그룹 목록 제목 -->
                    <div class="divider-media-group-title-frame">
                        <span class="divider-media-group-title">분석 미디어그룹 목록</span>
                    </div>
                    <!-- 미디어그룹 목록 -->
                    <div class="divider-media-group-list" id="divider-media-group-list">
                        <!-- 서버에서 제공하는 미디어그룹 키(a, b, c 등)에 따라 목록이 생성됩니다 -->
                        <div class="divider-media-group-item" data-media-group-key="a">a. {{미디어그룹명_a}}</div>
                        <div class="divider-media-group-item" data-media-group-key="b">b. {{미디어그룹명_b}}</div>
                        <div class="divider-media-group-item" data-media-group-key="c">c. {{미디어그룹명_c}}</div>
                    </div>
                </div>
                <div class="divider-logo">
                    <img src="logo-black.png" alt="ADeX 로고" class="logo-image">
                </div>
            </div>
            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 13: 미디어그룹별 효과 분석 상세 -->
    <section class="page page-media-info page-media-group-detail">
        <div class="container container-media-info">
            <!-- head: 헤더 영역 (Frame 10) -->
            <div class="frame-head">
                <!-- top title: 상단 Breadcrumb -->
                <div class="frame-top-title">
                    <!-- top title: Breadcrumb 그룹 -->
                    <div class="frame-top-title-group">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹별 효과 분석</span>
                        <span class="text-separator-media">></span>
                        <span class="text-미디어그룹명-media">{{미디어그룹명}}</span>
                    </div>
                    <!-- adex: 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                    <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
                </div>
                <!-- sub title: 타이틀 영역 (Frame 9) -->
                <div class="frame-sub-title frame-sub-title-media-group">
                    <h1 class="text-media-title text-media-group-title">{{미디어그룹명}}</h1>
                    <!-- Frame 1686563118: 서브타이틀 -->
                    <div class="frame-media-subtitle">
                        <div class="frame-subtitle-line-1">
                            <span class="text-media-group-subtitle">{{광고물유형}}</span>
                            <span class="text-media-group-subtitle-separator">이며, </span>
                        </div>
                        <div class="frame-subtitle-line-2">
                            <span class="text-media-group-subtitle">{{장소적 특징}}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Frame 1686563155: 콘텐츠 영역 -->
            <div class="media-detail-content">
                <!-- 지도와 미디어그룹 광고 개요 컨테이너 -->
                <div class="frame-media-map-overview-container">
                    <!-- Frame 30: 지도 영역 -->
                    <div class="frame-media-map-image">
                        <div
                            id="map-{{미디어그룹번호}}"
                            class="media-group-map"
                            data-lat="{{위도}}"
                            data-lng="{{경도}}"
                            aria-label="미디어그룹 지도">
                        </div>
                    </div>

                    <!-- Frame 20: 미디어그룹 광고 개요 -->
                    <div class="frame-media-overview">
                <!-- Frame 21: 제목 + 광고 기간 정보 -->
                <div class="frame-media-overview-header">
                    <h2 class="text-media-group-overview-title">미디어그룹 광고 개요</h2>
                    <!-- Frame 1686563134: 광고 기간 정보 -->
                    <div class="data-period-wrapper">
                        <span class="data-info-text">광고 기간: </span>
                        <div class="data-period-range">
                            <div class="data-period-range-inner">
                                <div class="data-period-start">
                                    <span class="data-info-text">{{광고시작일}}</span>
                                </div>
                                <span class="data-info-text">~</span>
                                <span class="data-info-text">{{광고종료일}}</span>
                            </div>
                            <div class="data-info-group">
                                <span class="data-info-text">(총 {{운영일수}}</span>
                                <span class="data-info-text">일)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Frame 13: 테이블 형태의 정보들 -->
                <div class="frame-media-info-table">
                    <!-- Frame 18: 첫 번째 행 (미디어 위치) -->
                    <div class="frame-media-info-row-1">
                        <div class="field field-label field-media-group">
                            <span class="field-text">미디어 위치</span>
                        </div>
                        <div class="field field-value field-media-group">
                            <span class="field-text">{{미디어위치}}</span>
                        </div>
                    </div>

                    <!-- Frame 20: 두 번째 행 (미디어 대수) -->
                    <div class="frame-media-info-row-2">
                        <div class="field field-label field-media-group field-tall">
                            <span class="field-text">미디어 대수</span>
                        </div>
                        <div class="field field-value field-media-group field-tall">
                            <span class="field-text field-text-bold">총 {{미디어대수}}대</span>
                            <span class="field-text">{{미디어유형/사이즈/간격/대수}}</span>
                        </div>
                    </div>

                    <!-- Frame 1686563156: 세 번째 행 (운영 시간) -->
                    <div class="frame-media-info-row-2">
                        <div class="field field-label field-media-group field-tall">
                            <span class="field-text">운영 시간</span>
                        </div>
                        <div class="field field-value field-media-group field-tall">
                            <span class="field-text">{{운영시간}}</span>
                        </div>
                    </div>

                    <!-- Frame 13: 네 번째 행 (콘텐츠 정보) -->
                    <div class="frame-media-info-row-3">
                        <div class="field field-label field-media-group">
                            <span class="field-text">콘텐츠 정보</span>
                        </div>
                        <div class="field field-value field-media-group">
                            <span class="field-text">{{콘텐츠정보}}</span>
                        </div>
                    </div>

                    <!-- Frame 1686563157: 다섯 번째 행 (광고 운영 방식) -->
                    <div class="frame-media-info-row-3">
                        <div class="field field-label field-media-group">
                            <span class="field-text">광고 운영 방식</span>
                        </div>
                        <div class="field field-value field-media-group">
                            <span class="field-text">{{광고운영방식}}</span>
                        </div>
                    </div>
                </div>
                    </div>
                </div>
            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 14: 미디어그룹별 효과 분석 상세 - 노출 효과 분석, 광고 송출 분석 -->
    <section class="page page-media-info page-media-group-detail">
        <div class="container container-media-info">
            <!-- Frame 8: 헤더 영역 -->
            <div class="chapter-2-header">
                <!-- Breadcrumb 그룹 -->
                <div class="breadcrumb-bar">
                    <!-- Breadcrumb 내부 -->
                    <div class="breadcrumb-items">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹별 효과 분석</span>
                        <span class="text-separator-media">></span>
                        <span class="text-미디어그룹명-media">{{미디어그룹명}}</span>
                    </div>
                </div>
                <!-- 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
            </div>

            <!-- Frame 1686563155: 콘텐츠 영역 -->
            <div class="media-detail-content">
                <!-- 노출 효과 분석 -->
                <div class="frame-exposure-analysis">
                    <!-- content title -->
                    <div class="frame-content-title">
                        <h2 class="text-media-group-overview-title">노출 효과 분석</h2>
                        <!-- 수집 기간 정보 -->
                        <div class="data-info-meta">
                            <span class="data-info-text">수집 기간: </span>
                            <div class="data-period-range">
                                <div class="data-period-range-inner">
                                    <div class="data-period-start">
                                        <span class="data-info-text">{{광고시작일}}</span>
                                    </div>
                                    <span class="data-info-text">~</span>
                                    <span class="data-info-text">{{광고종료일}}</span>
                                </div>
                            </div>
                            <span class="data-info-text">| 산출 기준: </span>
                            <div class="data-info-wrapper">
                                <div class="data-info-group">
                                    <span class="data-info-text">유동・노출인구 총합</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 노출 효과 분석 테이블 -->
                    <div class="frame-exposure-analysis-table">
                        <!-- Frame 18: 첫 번째 행 -->
                        <div class="frame-media-info-row-1">
                            <div class="field field-label field-media-group">
                                <span class="field-text">유동인구</span>
                            </div>
                            <div class="field field-value field-media-group field-bg-light">
                                <span class="field-text">{{circulation}}명</span>
                            </div>
                            <div class="field field-label field-media-group">
                                <span class="field-text">노출인구</span>
                            </div>
                            <div class="field field-value field-media-group field-bg-light">
                                <span class="field-text">{{ots}}명</span>
                            </div>
                        </div>

                        <!-- Frame 20: 두 번째 행 -->
                        <div class="frame-media-info-row-2">
                            <div class="field field-label field-media-group">
                                <span class="field-text">유동 대비 노출 비율</span>
                            </div>
                            <div class="field field-value field-media-group field-bg-light">
                                <span class="field-text">{{circulation대비ots비율}}%</span>
                            </div>
                            <div class="field field-label field-media-group">
                                <span class="field-text">CPM<span class="field-text-small"> (노출인구 기준) </span></span>
                            </div>
                            <div class="field field-value field-media-group field-bg-light field-value-currency">
                                <span class="field-text-small field-text-blue">(광고비 {{광고비}} 만원 기준)</span><span class="field-text">{{CPM}}원</span>
                            </div>
                        </div>

                        <!-- Frame 21: 세 번째 행 -->
                        <div class="frame-media-info-row-3">
                            <div class="field field-label field-media-group">
                                <span class="field-text">주요 오디언스</span>
                            </div>
                            <div class="field field-value field-media-group field-bg-light">
                                <span class="field-text">{{주요오디언스}} ({{주요오디언스비율}}%)</span>
                            </div>
                            <div class="field field-label field-media-group">
                                <span class="field-text">주요 요일/시간대</span>
                            </div>
                            <div class="field field-value field-media-group field-bg-light">
                                <span class="field-text">{{주요요일}} / {{주요시간대}}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 광고 송출 분석 -->
                <div class="frame-ad-delivery-analysis">
                    <!-- content title -->
                    <div class="frame-content-title">
                        <h2 class="text-media-group-overview-title">광고 송출 분석</h2>
                        <!-- Frame 1686563134: 수집 기간 정보 -->
                        <div class="data-period-wrapper">
                            <span class="data-info-text">수집 기간: </span>
                                <div class="data-period-range">
                                    <div class="data-period-range-inner">
                                        <div class="data-period-start">
                                        <span class="data-info-text">{{광고시작일}}</span>
                                    </div>
                                    <span class="data-info-text">~</span>
                                    <span class="data-info-text">{{광고종료일}}</span>
                                </div>
                            </div>
                            <span class="data-info-text">| 데이터 출처: </span>
                            <span class="data-info-text">재생 로그 및 미디어사 제공 데이터</span>
                            <span class="data-info-text">| 산출 기준: </span>
                            <div class="data-info-wrapper">
                                <div class="data-info-group">
                                    <span class="data-info-text">전체 일반・싱크 스케줄/ 일 평균 계산 기준</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 광고 송출 분석 테이블 -->
                    <div class="frame-ad-delivery-analysis-table">
                        <!-- Frame 18: 첫 번째 행 -->
                        <div class="frame-media-info-row-1">
                            <div class="field field-label field-media-group">
                                <span class="field-text">총 송출 횟수</span>
                            </div>
                            <div class="field field-value field-media-group field-bg-light">
                                <span class="field-text">일반 {{일반송출횟수}} 회/ 싱크 {{싱크송출횟수}} 회</span>
                            </div>
                        </div>

                        <!-- Frame 20: 두 번째 행 -->
                        <div class="frame-media-info-row-2">
                            <div class="field field-label field-media-group field-tall">
                                <span class="field-text field-text-14">일 평균 송출 횟수<br>/ 일 최소 송출 보장수</span>
                            </div>
                            <div class="field field-value field-media-group field-tall field-bg-light">
                                <span class="field-text">{{일평균송출횟수}}회 / {{일최소송출보장수}}회</span>
                            </div>
                        </div>

                        <!-- Frame 13: 세 번째 행 -->
                        <div class="frame-media-info-row-3">
                            <div class="field field-label field-media-group">
                                <span class="field-text">송출 보장 달성률</span>
                            </div>
                            <div class="field field-value field-media-group field-bg-light">
                                <span class="field-text">{{송출보장달성률}}%</span>
                            </div>
                        </div>

                        <!-- Frame 21: 네 번째 행 -->
                        <div class="frame-media-info-row-3">
                            <div class="field field-label field-media-group">
                                <span class="field-text">평균 송출 주기</span>
                            </div>
                            <div class="field field-value field-media-group field-bg-light">
                                <span class="field-text">약 {{평균송출주기}}초</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 타임 광고 송출 분석 -->
                <!-- 타임 광고 운영 여부에 따라 visible/invisible 처리 -->
                <!-- 서버 측에서 {{타임광고운영여부}} 값에 따라 style="display: none;" 또는 class="invisible" 추가 -->
                <!-- 예시: {{#if 타임광고운영여부}} 또는 {% if 타임광고운영여부 %} -->
                <div class="frame-time-ad-delivery-analysis" data-time-ad-enabled="true">
                    <!-- content title -->
                    <div class="frame-content-title">
                        <h2 class="text-media-group-overview-title">타임 광고 송출 분석</h2>
                        <!-- Frame 1686563134: 수집 기간 정보 -->
                        <div class="data-period-wrapper">
                            <span class="data-info-text">수집 기간: </span>
                            <div class="data-period-range">
                                <div class="data-period-range-inner">
                                    <div class="data-period-start">
                                        <span class="data-info-text">{{광고시작일}}</span>
                                    </div>
                                    <span class="data-info-text">~</span>
                                    <span class="data-info-text">{{광고종료일}}</span>
                                </div>
                            </div>
                            <span class="data-info-text">| 데이터 출처: </span>
                            <span class="data-info-text">재생 로그 및 미디어사 제공 데이터</span>
                            <span class="data-info-text">| 산출 기준: </span>
                            <div class="data-info-wrapper">
                                <div class="data-info-group">
                                    <span class="data-info-text">전체 타임 스케줄/ 총 노출 시간 기준</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 타임 광고 송출 분석 테이블 -->
                    <div class="frame-time-ad-delivery-analysis-table">
                        <!-- Frame 20: 첫 번째 행 -->
                        <div class="frame-media-info-row-2">
                            <div class="field field-label field-media-group field-tall">
                                <span class="field-text field-text-14">총 노출 시간<br>/ 총 노출 보장 시간</span>
                            </div>
                            <div class="field field-value field-media-group field-tall field-bg-light">
                                <span class="field-text">{{총노출시간}}시간 / {{총노출보장시간}}시간</span>
                            </div>
                        </div>

                        <!-- Frame 13: 두 번째 행 -->
                        <div class="frame-media-info-row-3">
                            <div class="field field-label field-media-group">
                                <span class="field-text">송출 보장 달성률</span>
                            </div>
                            <div class="field field-value field-media-group field-bg-light">
                                <span class="field-text">{{타임송출보장달성률}}%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 15: 노출 효과 시각화 -->
    <section class="page page-media-info page-exposure-visualization">
        <div class="container container-media-info">
            <!-- Frame 8: 헤더 영역 -->
            <div class="chapter-2-header">
                <!-- Breadcrumb 그룹 -->
                <div class="breadcrumb-bar">
                    <!-- Breadcrumb 내부 -->
                    <div class="breadcrumb-items">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹별 효과 분석</span>
                        <span class="text-separator-media">></span>
                        <span class="text-미디어그룹명-media">{{미디어그룹명}}</span>
                    </div>
                </div>
                <!-- 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
            </div>

            <!-- Container: 제목 영역 -->
            <div class="frame-exposure-visualization-title">
                <h2 class="text-media-group-overview-title">노출 효과 시각화</h2>
                <!-- 수집 기간 정보 -->
                <div class="data-info-meta">
                    <span class="data-info-text">수집 기간: </span>
                    <div class="data-period-range">
                        <div class="data-period-range-inner">
                            <div class="data-period-start">
                                <span class="data-info-text">{{광고시작일}}</span>
                            </div>
                            <span class="data-info-text">~</span>
                            <span class="data-info-text">{{광고종료일}}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Frame 1686563156: 차트 영역 컨테이너 -->
            <div class="visualization-section">
                <!-- Frame 1686563158: 연령・성별 분포 차트 -->
                <div class="frame-visualization-age-gender">
                    <!-- Container: 차트 제목 -->
                    <div class="frame-visualization-chart-title">
                        <div class="frame-visualization-icon">
                            <img src="agegender icon.svg" alt="차트 아이콘" class="visualization-icon">
                        </div>
                        <h3 class="text-visualization-chart-title">연령・성별 분포</h3>
                        <!-- 산출 기준 -->
                        <div class="data-info-meta">
                            <span class="data-info-text">산출 기준: </span>
                            <div class="data-info-wrapper">
                                <div class="data-info-group">
                                    <span class="data-info-text">노출인구 총합</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Frame 1686563126: 차트 컨테이너 -->
                    <div class="frame-visualization">
                        <canvas id="chart-canvas-mediagroup-ots-pyramid"></canvas>

                        <!-- Container: 범례 영역 -->
                        <div class="visualization-legend-age-gender">
                            <!-- 범례가 동적으로 생성됩니다 -->
                        </div>

                        <!-- Frame 22: 인사이트 -->
                        <div class="frame-insight frame-insight-visualization">
                            <!-- Frame 24: 아이콘 + 텍스트 컨테이너 -->
                            <div class="frame-insight-header">
                                <!-- Auto awesome: 아이콘 -->
                                <img src="insight icon.svg" alt="인사이트 아이콘" class="insight-icon">
                                <!-- Frame 1686563124: 텍스트 컨테이너 -->
                                <div class="visualization-insight-text">
                                    <span>노출인구가 가장 많은 연령・성별은 </span>
                                    <span class="visualization-insight-highlight">
                                        <span class="insight-value">{{최다연령성별}}</span>
                                        <span>입니다.</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Frame 1686563129: 일별 노출인구 차트 -->
                <div class="frame-visualization-daily">
                    <!-- Container: 차트 제목 -->
                    <div class="frame-visualization-chart-title">
                        <div class="frame-visualization-icon">
                            <img src="daily icon.svg" alt="차트 아이콘" class="visualization-icon">
                        </div>
                        <h3 class="text-visualization-chart-title">일별 노출인구</h3>
                        <!-- 산출 기준 -->
                        <div class="data-info-meta">
                            <span class="data-info-text">산출 기준: </span>
                            <div class="data-info-wrapper">
                                <div class="data-info-group">
                                    <span class="data-info-text">일별 노출인구</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Frame 1686563126: 차트 컨테이너 -->
                    <div class="frame-visualization">
                        <!-- 총합이 가장 많은 날의 값 표시 -->
                        <div class="daily-chart-total" id="daily-chart-total-visualization"></div>
                        
                        <canvas id="chart-canvas-mediagroup-ots-daily"></canvas>

                        <!-- Container: 범례 영역 -->
                        <div class="visualization-legend-daily">
                            <!-- 범례가 동적으로 생성됩니다 -->
                        </div>

                        <!-- Frame 22: 인사이트 -->
                        <div class="frame-insight frame-insight-visualization">
                            <!-- Frame 24: 아이콘 + 텍스트 컨테이너 -->
                            <div class="frame-insight-header">
                                <!-- Auto awesome: 아이콘 -->
                                <img src="insight icon.svg" alt="인사이트 아이콘" class="insight-icon">
                                <!-- Frame 1686563124: 텍스트 컨테이너 -->
                                <div class="visualization-insight-text">
                                    <span>노출인구가 가장 많은 날은 </span>
                                    <span class="visualization-insight-highlight">
                                        <span class="insight-value">{{최다날짜}}</span>
                                        <span>입니다.</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 페이지 16: 요일별/시간대별 노출인구 비교 -->
    <section class="page page-media-info page-exposure-visualization">
        <div class="container container-media-info">
            <!-- Frame 8: 헤더 영역 -->
            <div class="chapter-2-header">
                <!-- Breadcrumb 그룹 -->
                <div class="breadcrumb-bar">
                    <!-- Breadcrumb 내부 -->
                    <div class="breadcrumb-items">
                        <span class="text-스케줄명-media">{{스케줄명}}</span>
                        <span class="text-separator-media">|</span>
                        <span class="text-목차-media">미디어그룹별 효과 분석</span>
                        <span class="text-separator-media">></span>
                        <span class="text-미디어그룹명-media">{{미디어그룹명}}</span>
                    </div>
                </div>
                <!-- 디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service -->
                <div class="text-platform-media">디지털 옥외광고 콘텐츠 미디어 통합 시스템 Dooh Service</div>
            </div>

            <!-- Container: 제목 영역 -->
            <div class="frame-exposure-visualization-title">
                <h2 class="text-media-group-overview-title">노출 효과 시각화</h2>
                <!-- 수집 기간 정보 -->
                <div class="data-info-meta">
                    <span class="data-info-text">수집 기간: </span>
                    <div class="data-period-range">
                        <div class="data-period-range-inner">
                            <div class="data-period-start">
                                <span class="data-info-text">{{광고시작일}}</span>
                            </div>
                            <span class="data-info-text">~</span>
                            <span class="data-info-text">{{광고종료일}}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Frame 1686563156: 차트 영역 컨테이너 -->
            <div class="visualization-section">
                <!-- Frame 1686563158: 요일별 노출인구 차트 -->
                <div class="frame-visualization-weekly">
                    <!-- Container: 차트 제목 -->
                    <div class="frame-visualization-chart-title">
                        <div class="frame-visualization-icon">
                            <img src="day icon.svg" alt="차트 아이콘" class="visualization-icon">
                        </div>
                        <h3 class="text-visualization-chart-title">요일별 노출인구</h3>
                        <!-- 산출 기준 -->
                        <div class="data-info-meta">
                            <span class="data-info-text">산출 기준: </span>
                            <div class="data-info-wrapper">
                                <div class="data-info-group">
                                    <span class="data-info-text">요일별 일 평균 노출인구</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Frame 1686563126: 차트 컨테이너 -->
                    <div class="frame-visualization">
                        <!-- 총합이 가장 많은 요일의 값 표시 -->
                        <div class="weekly-chart-max-value" id="weekly-chart-max-value-visualization"></div>
                        
                        <canvas id="chart-canvas-mediagroup-ots-weekly"></canvas>

                        <!-- Container: 범례 영역 -->
                        <div class="visualization-legend-weekly">
                            <!-- 범례가 동적으로 생성됩니다 -->
                        </div>

                        <!-- Frame 22: 인사이트 -->
                        <div class="frame-insight frame-insight-visualization">
                            <!-- Frame 24: 아이콘 + 텍스트 컨테이너 -->
                            <div class="frame-insight-header">
                                <!-- Auto awesome: 아이콘 -->
                                <img src="insight icon.svg" alt="인사이트 아이콘" class="insight-icon">
                                <!-- Frame 1686563124: 텍스트 컨테이너 -->
                                <div class="visualization-insight-text">
                                    <span>노출인구가 가장 많은 요일은 </span>
                                    <span class="visualization-insight-highlight">
                                        <span class="insight-value">{{최다요일}}</span>
                                        <span>입니다.</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Frame 1686563129: 시간대별 노출인구 차트 -->
                <div class="frame-visualization-hourly">
                    <!-- Container: 차트 제목 -->
                    <div class="frame-visualization-chart-title">
                        <div class="frame-visualization-icon">
                            <img src="time icon.svg" alt="차트 아이콘" class="visualization-icon">
                        </div>
                        <h3 class="text-visualization-chart-title">시간대별 노출인구</h3>
                        <!-- 산출 기준 -->
                        <div class="data-info-meta">
                            <span class="data-info-text">산출 기준: </span>
                            <div class="data-info-wrapper">
                                <div class="data-info-group">
                                    <span class="data-info-text">시간대별 평균 노출인구</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Frame 1686563126: 차트 컨테이너 -->
                    <div class="frame-visualization">
                        <!-- 총합이 가장 많은 시간대의 값 표시 -->
                        <div class="hourly-chart-max-value" id="hourly-chart-max-value-visualization"></div>
                        
                        <canvas id="chart-canvas-mediagroup-ots-hourly"></canvas>

                        <!-- Container: 범례 영역 -->
                        <div class="visualization-legend-hourly">
                            <!-- 범례가 동적으로 생성됩니다 -->
                        </div>

                        <!-- Frame 22: 인사이트 -->
                        <div class="frame-insight frame-insight-visualization">
                            <!-- Frame 24: 아이콘 + 텍스트 컨테이너 -->
                            <div class="frame-insight-header">
                                <!-- Auto awesome: 아이콘 -->
                                <img src="insight icon.svg" alt="인사이트 아이콘" class="insight-icon">
                                <!-- Frame 1686563124: 텍스트 컨테이너 -->
                                <div class="visualization-insight-text">
                                    <span>노출인구가 가장 많은 시간대는 </span>
                                    <span class="visualization-insight-highlight">
                                        <span class="insight-value">{{최다시간대}}</span>
                                        <span>입니다.</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 페이지 번호 -->
            <div class="page-number"></div>
        </div>
    </section>

    <!-- 끝 표지 페이지 -->
    <section class="page page-media-info page-back-cover">
        <div class="container container-media-info">
            <!-- Back cover main 컨테이너 -->
            <div class="back-cover-container">
                <!-- 로고 및 서비스 운영팀 -->
                <div class="back-cover-header">
                    <!-- 로고 이미지 -->
                    <div class="frame-logo-back-cover">
                        <img src="icon-group.png" alt="ADeX 로고" class="logo-back-cover">
                    </div>
                    <!-- Dooh Service 서비스 운영팀 -->
                    <div class="text-service-team-back-cover">Dooh Service 서비스 운영팀</div>
                </div>

                <!-- Rectangle 14: 구분선 -->
                <div class="rectangle-14-back-cover"></div>

                <!-- 문의 안내 -->
                <div class="back-cover-contact">
                    <div class="text-inquiry-back-cover">추가 문의 사항이 있으시다면 아래 이메일을 통해 문의를 남겨주시기 바랍니다.</div>
                    <div class="text-email-back-cover">contact@mnmnetworks.com</div>
                </div>

                <!-- Frame 7: 하단 로고 및 저작권 -->
                <div class="frame-back-cover-footer">
                    <!-- 로고 이미지 -->
                    <div class="frame-logo-bottom-back-cover">
                        <img src="mnm logo.svg" alt="M&M Networks 로고" class="logo-bottom-back-cover">
                    </div>
                    <!-- 저작권 정보 -->
                    <div class="text-copyright-back-cover">copyrightⓒ{{보고서발행연도}} M&M Networks Corp . All rights reserved</div>
                </div>
            </div>
        </div>
    </section>


    <script>
        // 성과 테이블 높이 감지 및 페이지 분할 처리
        function handlePerformance3PageBreak() {
            const performanceTables = document.querySelectorAll('.frame-table-performance3');
            performanceTables.forEach((table) => {
                const rect = table.getBoundingClientRect();
                const actualHeight = rect.height;
                
                if (actualHeight >= 349) {
                    table.style.maxHeight = 'none';
                    table.style.pageBreakInside = 'auto';
                    table.style.breakInside = 'auto';
                }
            });
        }
        
        // 페이지 로드 후 및 리사이즈 시 실행
        window.addEventListener('load', handlePerformance3PageBreak);
        window.addEventListener('resize', handlePerformance3PageBreak);
        
        // field-label field-tall의 높이를 field-value-item들의 총 높이에 맞추기
        function syncFieldTallHeight() {
            const detailRows = document.querySelectorAll('.frame-media-info-row-2, .frame-media-info-row-3');
            detailRows.forEach((row) => {
                const fieldValueTalls = row.querySelectorAll('.field-value.field-tall');
                const fieldLabelTalls = row.querySelectorAll('.field-label.field-tall');
                
                // 각 field-value field-tall의 높이 계산
                let maxHeight = 0;
                fieldValueTalls.forEach((fieldValueTall) => {
                    const fieldValueItems = fieldValueTall.querySelectorAll('.field-value-item');
                    let totalHeight = 0;
                    
                    fieldValueItems.forEach((item) => {
                        totalHeight += item.offsetHeight;
                    });
                    
                    if (totalHeight > maxHeight) {
                        maxHeight = totalHeight;
                    }
                });
                
                // 같은 행의 모든 field-label field-tall과 field-value field-tall의 높이를 동일하게 설정
                // padding-top (16px)을 고려하여 높이 설정
                if (maxHeight > 0) {
                    const targetHeight = maxHeight + 16; // padding-top 포함
                    fieldLabelTalls.forEach((fieldLabelTall) => {
                        fieldLabelTall.style.height = targetHeight + 'px';
                    });
                    fieldValueTalls.forEach((fieldValueTall) => {
                        fieldValueTall.style.height = maxHeight + 'px';
                    });
                }
            });
        }
        
        // text-pitch-note의 위치를 필드(테이블) 아래 20px 간격으로 설정
        function syncPitchNotePosition() {
            const pitchNotes = document.querySelectorAll('.text-pitch-note');
            pitchNotes.forEach((pitchNote) => {
                const frameContent = pitchNote.closest('.frame-내용');
                if (frameContent) {
                    const frameTable = frameContent.querySelector('.frame-table');
                    if (frameTable) {
                        const tableRect = frameTable.getBoundingClientRect();
                        const contentRect = frameContent.getBoundingClientRect();
                        const tableBottom = tableRect.bottom - contentRect.top;
                        // 테이블 하단 + 20px 간격
                        pitchNote.style.top = (tableBottom + 20) + 'px';
                    }
                }
            });
        }
        
        // frame-insight의 위치를 상단 요소 아래 12px 간격으로 설정
        function syncInsightPosition() {
            const insights = document.querySelectorAll('.frame-circulation-ots .frame-insight');
            insights.forEach((insight) => {
                const frameCirculationOts = insight.closest('.frame-circulation-ots');
                if (frameCirculationOts) {
                    const table = frameCirculationOts.querySelector('.frame-table');
                    if (table) {
                        const tableRect = table.getBoundingClientRect();
                        const frameRect = frameCirculationOts.getBoundingClientRect();
                        const tableBottom = tableRect.bottom - frameRect.top;
                        // 테이블 하단 + 12px 간격
                        insight.style.top = (tableBottom + 12) + 'px';
                    }
                }
            });
        }

        // Frame 21을 circulation/ots 인사이트 아래 40px에 동적으로 배치
        function syncFrame21Position() {
            const frameCirculationOts = document.querySelector('.frame-circulation-ots');
            const frame21 = document.querySelector('.frame-audience-summary');
            if (frameCirculationOts && frame21) {
                const insight = frameCirculationOts.querySelector('.frame-insight');
                if (insight) {
                    const frameContents = frameCirculationOts.closest('.frame-contents');
                    if (frameContents) {
                        const frameContentsRect = frameContents.getBoundingClientRect();
                        const insightRect = insight.getBoundingClientRect();
                        const insightBottom = insightRect.bottom - frameContentsRect.top;
                        // 인사이트 하단 + 40px 간격
                        frame21.style.top = (insightBottom + 40) + 'px';
                    }
                }
            }
        }

        // Frame 22를 Frame 21 아래 80px에 동적으로 배치
        function syncFrame22Position() {
            const frame21 = document.querySelector('.frame-audience-summary');
            const frame22 = document.querySelector('.frame-max-exposure-group');
            if (frame21 && frame22) {
                const frameContents = frame21.closest('.frame-contents');
                if (frameContents) {
                    const frameContentsRect = frameContents.getBoundingClientRect();
                    const frame21Rect = frame21.getBoundingClientRect();
                    const frame21Bottom = frame21Rect.bottom - frameContentsRect.top;
                    // Frame 21 하단 + 80px 간격
                    frame22.style.top = (frame21Bottom + 80) + 'px';
                }
            }
        }
        
        // frame-insight-notice를 주요 광고 성과 3의 마지막 페이지 하단에 배치 (원칙: 항상 페이지 하단)
        function syncInsightNoticePosition() {
            const performanceChartContainer = document.querySelector('.page-performance-3 .performance-chart-container');
            const performanceTable = performanceChartContainer ? performanceChartContainer.querySelector('.frame-table-performance3') : null;
            const frameInsightNotice = performanceChartContainer ? performanceChartContainer.querySelector('.frame-insight-notice') : null;
            
            if (performanceChartContainer && performanceTable && frameInsightNotice) {
                const container = performanceChartContainer.closest('.container');
                if (!container) return;
                
                const containerRect = container.getBoundingClientRect();
                const frame20Rect = performanceTable.getBoundingClientRect();
                const performanceChartRect = performanceChartContainer.getBoundingClientRect();
                const frameInsightNoticeRect = frameInsightNotice.getBoundingClientRect();
                
                // 페이지 높이 (A4 가로: 794px)
                const pageHeight = 794;
                
                // container의 시작 위치 (페이지 내에서)
                const containerStart = containerRect.top;
                
                // performance-chart-container의 시작 위치 (container 기준)
                const performanceChartTop = performanceChartRect.top - containerStart;
                
                // performance-chart-container의 실제 높이 (여러 페이지에 걸쳐 있을 수 있음)
                const performanceChartHeight = performanceChartRect.height;
                
                // performance-chart-container의 끝나는 위치 (container 기준)
                const performanceChartEndInPage = performanceChartTop + performanceChartHeight;
                
                // performance-chart-container가 끝나는 페이지의 하단 계산
                const performanceChartLastPageBottom = Math.ceil(performanceChartEndInPage / pageHeight) * pageHeight;
                
                // container의 하단 위치
                const containerBottomValue = containerRect.height;
                
                // 마지막 페이지의 하단이 container의 하단보다 아래면 container의 하단 사용
                const targetBottomValue = Math.min(performanceChartLastPageBottom, containerBottomValue);
                
                // performance-chart-container 내에서 frame-insight-notice를 마지막 페이지 하단에 배치 (54px 여백)
                // targetBottomValue는 container 기준이므로, performance-chart-container 기준으로 변환
                const bottomPosition = (targetBottomValue - performanceChartTop) - 54;
                frameInsightNotice.style.bottom = Math.max(0, bottomPosition) + 'px';
                frameInsightNotice.style.position = 'absolute';
                frameInsightNotice.style.left = '0px';
            }
        }

        // CPM 공식 텍스트를 성과 테이블 하단에 12px 여백을 두고 배치
        function syncCpmFormulaPosition() {
            const performanceChartContainer = document.querySelector('.performance-chart-container');
            const performanceTable = performanceChartContainer ? performanceChartContainer.querySelector('.frame-table-performance3') : null;
            const frameCpmFormula = performanceChartContainer ? performanceChartContainer.querySelector('.frame-cpm-formula') : null;
            
            if (performanceChartContainer && performanceTable && frameCpmFormula) {
                const frameRect = performanceChartContainer.getBoundingClientRect();
                const frame20Rect = performanceTable.getBoundingClientRect();
                const frame20Bottom = frame20Rect.bottom - frameRect.top;
                // 성과 테이블 하단 + 12px 여백
                frameCpmFormula.style.top = (frame20Bottom + 12) + 'px';
                frameCpmFormula.style.position = 'absolute';
                frameCpmFormula.style.left = '0px';
            }
        }

        // frame-insight-notice를 주요 광고 성과 2 페이지의 마지막 페이지 하단에 배치 (원칙: 항상 페이지 하단)
        function syncInsightNoticePosition2() {
            const performanceChartSection = document.querySelector('.page-performance-2 .performance-chart-section');
            const frameInsightNotice = performanceChartSection ? performanceChartSection.querySelector('.frame-insight-notice') : null;
            
            if (performanceChartSection && frameInsightNotice) {
                // frame-insight-notice를 페이지 하단에 배치 (54px 여백)
                frameInsightNotice.style.bottom = '54px';
                frameInsightNotice.style.position = 'absolute';
                frameInsightNotice.style.left = '0px';
            }
        }

        // syncFieldTallHeight 실행 후 syncPitchNotePosition, syncInsightPosition 실행 (테이블 높이 계산 후 위치 설정)
        function syncAllHeights() {
            syncFieldTallHeight();
            // 약간의 지연 후 실행하여 테이블 높이 계산 완료 후 위치 설정
            setTimeout(() => {
                syncPitchNotePosition();
                syncInsightPosition();
                syncFrame21Position();
                syncFrame22Position();
                syncInsightNoticePosition();
                syncInsightNoticePosition2(); // 주요 광고 성과 2 페이지
                syncCpmFormulaPosition();
            }, 0);
        }
        
        window.addEventListener('load', syncAllHeights);
        window.addEventListener('resize', syncAllHeights);

        // 타임 광고 송출 분석 visible/invisible 처리
        function handleTimeAdDeliveryAnalysis() {
            const timeAdElements = document.querySelectorAll('.frame-time-ad-delivery-analysis');
            timeAdElements.forEach((timeAdElement) => {
                // 타임 광고 운영 여부 확인
                const timeAdEnabled = timeAdElement.getAttribute('data-time-ad-enabled');
                const isEnabled = timeAdEnabled === 'true' || timeAdEnabled === '1' || timeAdEnabled === 'yes';
                
                if (!isEnabled) {
                    // invisible 처리
                    timeAdElement.style.display = 'none';
                    return;
                }
                
                // visible 처리
                timeAdElement.style.display = 'block';
            });
        }
        
        // 페이지 로드 후 실행
        window.addEventListener('load', () => {
            setTimeout(handleTimeAdDeliveryAnalysis, 100);
        });
        window.addEventListener('resize', () => {
            setTimeout(handleTimeAdDeliveryAnalysis, 100);
        });

        // 소수점 값 올림 처리 함수
        function roundUpAllDecimals() {
            // 모든 텍스트 노드를 순회하면서 % 기호 앞의 소수점 값들을 올림 처리
            const walker = document.createTreeWalker(
                document.body,
                NodeFilter.SHOW_TEXT,
                null,
                false
            );

            let node;
            const textNodes = [];
            while (node = walker.nextNode()) {
                // 템플릿 변수나 이미 처리된 노드는 제외
                if (node.textContent && !node.textContent.includes('{{') && !node.textContent.includes('{%')) {
                    textNodes.push(node);
                }
            }

            textNodes.forEach(textNode => {
                let text = textNode.textContent;
                
                // 소수점이 포함된 숫자 패턴 찾기 (예: 58.2%, 45.1% 등)
                // 정규식: 소수점이 있는 숫자 뒤에 %가 오는 경우
                text = text.replace(/(\d+\.\d+)%/g, (match, num) => {
                    const rounded = Math.ceil(parseFloat(num));
                    return rounded + '%';
                });
                
                // 괄호 안의 소수점 값 (예: (45.1%), (30.1%) 등)
                text = text.replace(/\((\d+\.\d+)%\)/g, (match, num) => {
                    const rounded = Math.ceil(parseFloat(num));
                    return '(' + rounded + '%)';
                });
                
                // 소수점만 있는 숫자 (괄호나 % 없이)
                text = text.replace(/(\d+\.\d+)/g, (match, num) => {
                    // 이미 처리된 경우 제외 (다음에 %나 )가 오는 경우)
                    if (match.includes('%') || match.includes(')')) {
                        return match;
                    }
                    const rounded = Math.ceil(parseFloat(num));
                    return rounded.toString();
                });

                if (text !== textNode.textContent) {
                    textNode.textContent = text;
                }
            });
        }

        // 페이지 로드 후 실행
        document.addEventListener('DOMContentLoaded', function() {
            roundUpAllDecimals();
            // 미디어그룹 목록 생성
            목차미디어그룹목록생성();
            divider미디어그룹목록생성();
        });

        // 동적 콘텐츠가 추가된 후에도 실행할 수 있도록 MutationObserver 추가
        const observer = new MutationObserver(function(mutations) {
            roundUpAllDecimals();
        });

        observer.observe(document.body, {
            childList: true,
            subtree: true,
            characterData: true
        });

        // 미디어그룹 별 circulation과 ots 차트 (주요 광고 성과 2)
        const chartCtx1686563131 = document.getElementById('chart-canvas-1686563131');
        if (chartCtx1686563131) {
            // 서버 측에서 템플릿 변수를 실제 데이터로 치환해야 합니다
            // 예시 구조:
            // const 미디어그룹별유동노출인구데이터 = {
            //     미디어그룹리스트: [
            //         {
            //             미디어그룹명: '강남역 2호선 지하철 광고',
            //             유동인구: 120000,
            //             노출인구: 85000,
            //             색상: 미디어그룹컬러팔레트[0],
            //         },
            //         {
            //             미디어그룹명: '홍대입구역 빌딩',
            //             유동인구: 80000,
            //             노출인구: 60000,
            //             색상: 미디어그룹컬러팔레트[1],
            //         }
            //     ]
            // };
            
            // 임시 데이터 (서버에서 위의 템플릿으로 치환)
            const 미디어그룹별circulationots데이터 = {
                미디어그룹리스트: [
                    {
                        미디어그룹명: '강남역 2호선 지하철 광고',
                        circulation: 120000,
                        ots: 85000,
                        색상: 미디어그룹컬러팔레트[0]
                    },
                    {
                        미디어그룹명: '홍대입구역 빌딩',
                        circulation: 80000,
                        ots: 60000,
                        색상: 미디어그룹컬러팔레트[1]
                    },
                    {
                        미디어그룹명: '시청역 빌딩',
                        circulation: 100000,
                        ots: 75000,
                        색상: 미디어그룹컬러팔레트[2]
                    }
                ]
            };

            const datasets = 미디어그룹별circulationots데이터.미디어그룹리스트.map((그룹, index) => {
                const 색상 = 그룹.색상 || 미디어그룹컬러팔레트[index % 미디어그룹컬러팔레트.length];
                const circulation색상 = '#4DADFF';
                const ots색상 = '#00C5A3';
                
                return [
                    {
                        label: `${그룹.미디어그룹명} - circulation`,
                        data: [그룹.circulation],
                        backgroundColor: circulation색상,
                        borderColor: circulation색상,
                        borderWidth: 0
                    },
                    {
                        label: `${그룹.미디어그룹명} - ots`,
                        data: [그룹.ots],
                        backgroundColor: ots색상,
                        borderColor: ots색상,
                        borderWidth: 0
                    }
                ];
            }).flat();

            const chart1686563131 = new Chart(chartCtx1686563131, {
                type: 'bar',
                data: {
                    labels: 미디어그룹별circulationots데이터.미디어그룹리스트.map(g => g.미디어그룹명),
                    datasets: datasets
                },
                options: {
                    indexAxis: 'x',
                    scales: {
                        x: {
                            stacked: false,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#616161'
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#757575',
                                callback: function(value) {
                                    return value.toLocaleString() + '명';
                                }
                            },
                            grid: {
                                display: true,
                                color: '#e0e0e0'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // 범례는 HTML로 별도 표시
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.parsed.y;
                                    return label + ': ' + value.toLocaleString() + '명';
                                }
                            },
                            titleFont: {
                                family: 'Pretendard',
                                size: 12
                            },
                            bodyFont: {
                                family: 'Pretendard',
                                size: 11
                            }
                        }
                    },
                    maintainAspectRatio: false,
                    responsive: true
                }
            });
        }

        // 미디어그룹별 유동인구와 노출인구 막대그래프 차트 (주요 광고 성과 2 - 페이지 6)
        const mediaGroupPopulationCtx = document.getElementById('chart-canvas-media-group-population');
        if (mediaGroupPopulationCtx) {
            // 서버 측에서 템플릿 변수를 실제 데이터로 치환해야 합니다
            // 예시 구조:
            // const 미디어그룹별유동노출인구데이터 = {
            //     미디어그룹리스트: [
            //         {
            //             미디어그룹명: '강남역 2호선 지하철 광고',
            //             유동인구: 120000,
            //             노출인구: 85000,
            //             색상: 미디어그룹컬러팔레트[0],
            //         },
            //         {
            //             미디어그룹명: '홍대입구역 빌딩',
            //             유동인구: 80000,
            //             노출인구: 60000,
            //             색상: 미디어그룹컬러팔레트[1],
            //         }
            //     ]
            // };
            
            // 임시 데이터 (서버에서 위의 템플릿으로 치환)
            const 미디어그룹별유동노출인구데이터 = {
                미디어그룹리스트: [
                    {
                        미디어그룹명: '강남역 2호선 지하철 광고',
                        유동인구: 120000,
                        노출인구: 85000,
                        색상: 미디어그룹컬러팔레트[0]
                    },
                    {
                        미디어그룹명: '홍대입구역 빌딩',
                        유동인구: 80000,
                        노출인구: 60000,
                        색상: 미디어그룹컬러팔레트[1]
                    },
                    {
                        미디어그룹명: '시청역 빌딩',
                        유동인구: 100000,
                        노출인구: 75000,
                        색상: 미디어그룹컬러팔레트[2]
                    },
                    {
                        미디어그룹명: '명동역 지하상가',
                        유동인구: 95000,
                        노출인구: 70000,
                        색상: 미디어그룹컬러팔레트[3]
                    }
                ]
            };

            // 유동인구 데이터셋
            const 유동인구데이터셋 = {
                label: '유동인구',
                data: 미디어그룹별유동노출인구데이터.미디어그룹리스트.map(g => g.유동인구),
                backgroundColor: '#4DADFF',
                borderColor: '#4DADFF',
                borderWidth: 0
            };

            // 노출인구 데이터셋
            const 노출인구데이터셋 = {
                label: '노출인구',
                data: 미디어그룹별유동노출인구데이터.미디어그룹리스트.map(g => g.노출인구),
                backgroundColor: '#00C5A3',
                borderColor: '#00C5A3',
                borderWidth: 0
            };

            const mediaGroupPopulationChart = new Chart(mediaGroupPopulationCtx, {
                type: 'bar',
                data: {
                    labels: 미디어그룹별유동노출인구데이터.미디어그룹리스트.map(g => g.미디어그룹명),
                    datasets: [유동인구데이터셋, 노출인구데이터셋]
                },
                options: {
                    indexAxis: 'x',
                    scales: {
                        x: {
                            stacked: false,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#616161',
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#757575',
                                callback: function(value) {
                                    return value.toLocaleString() + '명';
                                }
                            },
                            grid: {
                                display: true,
                                color: '#e0e0e0'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // 범례는 HTML로 별도 표시
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.parsed.y;
                                    return label + ': ' + value.toLocaleString() + '명';
                                }
                            },
                            titleFont: {
                                family: 'Pretendard',
                                size: 12
                            },
                            bodyFont: {
                                family: 'Pretendard',
                                size: 11
                            }
                        }
                    },
                    maintainAspectRatio: false,
                    responsive: true
                }
            });
        }

        // 인구 피라미드 차트 (주요 광고 성과 4) - 여러 미디어그룹 비교
        const pyramidContainer = document.getElementById('pyramid-comparison-container');
        if (pyramidContainer) {
            // 서버 측에서 템플릿 변수를 실제 데이터로 치환해야 합니다
            // 예시 구조:
            // const 미디어그룹별연령대데이터 = [
            //     {
            //         미디어그룹명: '강남역 2호선 지하철 광고',
            //         연령대별데이터: [
            //             { 연령대: '10-14세', 남성: 120, 여성: 110 },
            //             { 연령대: '15-19세', 남성: 150, 여성: 140 },
            //             { 연령대: '20-24세', 남성: 200, 여성: 180 },
            //             { 연령대: '25-29세', 남성: 180, 여성: 190 },
            //             { 연령대: '30대', 남성: 4200, 여성: 4600 },
            //             { 연령대: '40대', 남성: 150, 여성: 160 },
            //             { 연령대: '50대', 남성: 100, 여성: 120 },
            //             { 연령대: '60대', 남성: 80, 여성: 90 },
            //             { 연령대: '70대 이상', 남성: 50, 여성: 60 }
            //         ]
            //     },
            //     {
            //         미디어그룹명: '홍대입구역 빌딩',
            //         연령대별데이터: [...]
            //     },
            //     {
            //         미디어그룹명: '시청역 빌딩',
            //         연령대별데이터: [...]
            //     }
            // ];
            
            // 임시 데이터 (서버에서 위의 템플릿으로 치환)
            const 미디어그룹별연령대데이터 = [
                {
                    미디어그룹명: '강남역 2호선 지하철 광고',
                    연령대별데이터: [
                        { 연령대: '10-14세', 남성: 120, 여성: 110 },
                        { 연령대: '15-19세', 남성: 150, 여성: 140 },
                        { 연령대: '20-24세', 남성: 200, 여성: 180 },
                        { 연령대: '25-29세', 남성: 180, 여성: 190 },
                        { 연령대: '30대', 남성: 4200, 여성: 4600 },
                        { 연령대: '40대', 남성: 150, 여성: 160 },
                        { 연령대: '50대', 남성: 100, 여성: 120 },
                        { 연령대: '60대', 남성: 80, 여성: 90 },
                        { 연령대: '70대 이상', 남성: 50, 여성: 60 }
                    ]
                },
                {
                    미디어그룹명: '홍대입구역 빌딩',
                    연령대별데이터: [
                        { 연령대: '10-14세', 남성: 100, 여성: 90 },
                        { 연령대: '15-19세', 남성: 130, 여성: 120 },
                        { 연령대: '20-24세', 남성: 180, 여성: 170 },
                        { 연령대: '25-29세', 남성: 4000, 여성: 4200 },
                        { 연령대: '30대', 남성: 180, 여성: 190 },
                        { 연령대: '40대', 남성: 140, 여성: 150 },
                        { 연령대: '50대', 남성: 90, 여성: 110 },
                        { 연령대: '60대', 남성: 70, 여성: 80 },
                        { 연령대: '70대 이상', 남성: 40, 여성: 50 }
                    ]
                },
                {
                    미디어그룹명: '시청역 빌딩',
                    연령대별데이터: [
                        { 연령대: '10-14세', 남성: 110, 여성: 100 },
                        { 연령대: '15-19세', 남성: 140, 여성: 130 },
                        { 연령대: '20-24세', 남성: 190, 여성: 180 },
                        { 연령대: '25-29세', 남성: 200, 여성: 210 },
                        { 연령대: '30대', 남성: 4300, 여성: 5200 },
                        { 연령대: '40대', 남성: 160, 여성: 170 },
                        { 연령대: '50대', 남성: 110, 여성: 130 },
                        { 연령대: '60대', 남성: 90, 여성: 100 },
                        { 연령대: '70대 이상', 남성: 60, 여성: 70 }
                    ]
                }
            ];

            // 모든 미디어그룹의 최대값 계산
            const maxValue = Math.max(
                ...미디어그룹별연령대데이터.flatMap(그룹 =>
                    그룹.연령대별데이터.map(item => Math.max(item.남성, item.여성))
                )
            );

            // 연령대 라벨 (모든 그룹이 동일한 연령대 사용)
            const 연령대라벨 = ['10-14세', '15-19세', '20-24세', '25-29세', '30대', '40대', '50대', '60대', '70대 이상'];

            // 각 미디어그룹별로 차트 생성
            미디어그룹별연령대데이터.forEach((그룹, index) => {
                // 차트 컨테이너 생성
                const chartWrapper = document.createElement('div');
                chartWrapper.className = 'pyramid-chart-wrapper';
                
                const chartDiv = document.createElement('div');
                chartDiv.className = 'pyramid-chart-container';
                const canvas = document.createElement('canvas');
                canvas.id = `chart-canvas-pyramid-${index}`;
                chartDiv.appendChild(canvas);
                chartWrapper.appendChild(chartDiv);
                
                // 차트 제목을 하단에 추가
                const chartTitle = document.createElement('div');
                chartTitle.className = 'pyramid-chart-title';
                chartTitle.textContent = 그룹.미디어그룹명;
                chartWrapper.appendChild(chartTitle);
                
                // 범례 영역 추가
                const legendDiv = document.createElement('div');
                legendDiv.className = 'pyramid-chart-legend';
                
                // 남성 범례
                const maleLegendItem = document.createElement('div');
                maleLegendItem.className = 'legend-item';
                const maleIcon = document.createElement('div');
                maleIcon.className = 'legend-icon legend-male';
                const maleText = document.createElement('span');
                maleText.className = 'legend-text';
                maleText.textContent = '남성';
                maleLegendItem.appendChild(maleIcon);
                maleLegendItem.appendChild(maleText);
                
                // 여성 범례
                const femaleLegendItem = document.createElement('div');
                femaleLegendItem.className = 'legend-item';
                const femaleIcon = document.createElement('div');
                femaleIcon.className = 'legend-icon legend-female';
                const femaleText = document.createElement('span');
                femaleText.className = 'legend-text';
                femaleText.textContent = '여성';
                femaleLegendItem.appendChild(femaleIcon);
                femaleLegendItem.appendChild(femaleText);
                
                legendDiv.appendChild(maleLegendItem);
                legendDiv.appendChild(femaleLegendItem);
                chartWrapper.appendChild(legendDiv);
                
                pyramidContainer.appendChild(chartWrapper);

                // 차트 데이터 준비
                const 남성데이터 = 연령대라벨.map(연령대 => {
                    const item = 그룹.연령대별데이터.find(d => d.연령대 === 연령대);
                    return item ? -item.남성 : 0; // 음수로 왼쪽에 표시
                });
                
                const 여성데이터 = 연령대라벨.map(연령대 => {
                    const item = 그룹.연령대별데이터.find(d => d.연령대 === 연령대);
                    return item ? item.여성 : 0; // 양수로 오른쪽에 표시
                });
                
                // 남성 최대값 찾기
                const 남성최대값 = Math.max(...남성데이터.map(v => Math.abs(v)));
                const 남성최대값인덱스 = 남성데이터.findIndex(v => Math.abs(v) === 남성최대값);
                
                // 여성 최대값 찾기
                const 여성최대값 = Math.max(...여성데이터);
                const 여성최대값인덱스 = 여성데이터.findIndex(v => v === 여성최대값);

                // 차트 생성
                // Y축은 첫 번째 차트(index === 0)에만 표시
                const showYAxis = index === 0;
                
                const pyramidChart = new Chart(canvas, {
                    type: 'bar',
                    data: {
                        labels: 연령대라벨,
                        datasets: [
                            {
                                label: '남성',
                                data: 남성데이터,
                                backgroundColor: '#4DADFF',
                                borderColor: '#4DADFF',
                                borderWidth: 0
                            },
                            {
                                label: '여성',
                                data: 여성데이터,
                                backgroundColor: '#FFA462',
                                borderColor: '#FFA462',
                                borderWidth: 0
                            }
                        ]
                    },
                    options: {
                        indexAxis: 'y',
                        layout: {
                            padding: {
                                left: showYAxis ? 0 : -50 // 첫 번째 차트가 아닌 경우 왼쪽 패딩 제거
                            }
                        },
                        datasets: {
                            bar: {
                                barThickness: 'flex',
                                categoryPercentage: 0.8, // 카테고리 간격 조정 (0.8 = 80%)
                                barPercentage: 0.9 // 막대 굵기 조정 (0.9 = 90%, 더 두껍게)
                            }
                        },
                        scales: {
                            x: {
                                stacked: false,
                                beginAtZero: true,
                                max: maxValue,
                                min: -maxValue,
                                ticks: {
                                    callback: function(value) {
                                        return Math.abs(value);
                                    },
                                    font: {
                                        family: 'Pretendard',
                                        size: 10
                                    },
                                    color: '#757575'
                                },
                                grid: {
                                    display: true,
                                    color: '#e0e0e0'
                                }
                            },
                            y: {
                                stacked: false,
                                ticks: {
                                    display: showYAxis, // 첫 번째 차트에만 Y축 라벨 표시
                                    font: {
                                        family: 'Pretendard',
                                        size: 10
                                    },
                                    color: '#616161'
                                },
                                grid: {
                                    display: false
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false // 범례는 HTML로 별도 표시
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const label = context.dataset.label || '';
                                        const value = Math.abs(context.parsed.x);
                                        return label + ': ' + value + '명';
                                    }
                                },
                                titleFont: {
                                    family: 'Pretendard',
                                    size: 12
                                },
                                bodyFont: {
                                    family: 'Pretendard',
                                    size: 11
                                }
                            }
                        },
                        maintainAspectRatio: false,
                        responsive: true,
                        animation: {
                            onComplete: function() {
                                const ctx = pyramidChart.ctx;
                                
                                // 남성 최대값 표시 (왼쪽 막대 안에)
                                if (남성최대값인덱스 >= 0) {
                                    const 남성Meta = pyramidChart.getDatasetMeta(0); // 남성 데이터셋
                                    const 남성막대 = 남성Meta.data[남성최대값인덱스];
                                    
                                    if (남성막대) {
                                        // 막대 안에 표시 (막대 중앙)
                                        const x = 남성막대.x; // 막대 중앙
                                        const y = 남성막대.y;
                                        
                                        // 텍스트 크기 측정
                                        ctx.save();
                                        ctx.font = '700 11px Pretendard';
                                        const text = 남성최대값.toLocaleString() + '명';
                                        const textMetrics = ctx.measureText(text);
                                        const textWidth = textMetrics.width;
                                        
                                        // 막대 너비 확인 (막대가 텍스트보다 넓은지 확인)
                                        const barWidth = Math.abs(남성막대.width);
                                        
                                        // 막대 안에 들어갈 수 있는 경우에만 표시
                                        if (textWidth < barWidth - 4) { // 양쪽 2px씩 여백
                                            ctx.fillStyle = '#000000';
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'middle';
                                            ctx.fillText(text, x, y);
                                        }
                                        ctx.restore();
                                    }
                                }
                                
                                // 여성 최대값 표시 (오른쪽 막대 안에)
                                if (여성최대값인덱스 >= 0) {
                                    const 여성Meta = pyramidChart.getDatasetMeta(1); // 여성 데이터셋
                                    const 여성막대 = 여성Meta.data[여성최대값인덱스];
                                    
                                    if (여성막대) {
                                        // 막대 안에 표시 (막대 중앙)
                                        const x = 여성막대.x; // 막대 중앙
                                        const y = 여성막대.y;
                                        
                                        // 텍스트 크기 측정
                                        ctx.save();
                                        ctx.font = '700 11px Pretendard';
                                        const text = 여성최대값.toLocaleString() + '명';
                                        const textMetrics = ctx.measureText(text);
                                        const textWidth = textMetrics.width;
                                        
                                        // 막대 너비 확인 (막대가 텍스트보다 넓은지 확인)
                                        const barWidth = Math.abs(여성막대.width);
                                        
                                        // 막대 안에 들어갈 수 있는 경우에만 표시
                                        if (textWidth < barWidth - 4) { // 양쪽 2px씩 여백
                                            ctx.fillStyle = '#000000';
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'middle';
                                            ctx.fillText(text, x, y);
                                        }
                                        ctx.restore();
                                    }
                                }
                            }
                        }
                    }
                });
            });
        }

        // 미디어그룹별 컬러 팔레트 (순서대로 적용, 밝게 조정)
        const 미디어그룹컬러팔레트 = [
            '#0389A1', // MG 1 (밝게 조정)
            '#00C5D9', // MG 2 (밝게 조정)
            '#0044C4', // MG 3 (밝게 조정)
            '#FF5252', // MG 4 (밝게 조정)
            '#B3D5EB', // MG 5 (밝게 조정)
            '#C6044B', // MG 6 (밝게 조정)
            '#0A56FF', // MG 7 (밝게 조정)
            '#0A7FFF', // MG 8 (밝게 조정)
            '#00CCFF', // MG 9 (밝게 조정)
            '#E02F05', // MG 10 (밝게 조정)
            '#FFE066', // MG 11 (밝게 조정)
            '#E1FF70', // MG 12 (밝게 조정)
            '#A8629F', // MG 13 (밝게 조정)
            '#2AA3D1', // MG 14 (밝게 조정)
            '#8DD4C6', // MG 15 (밝게 조정)
            '#F255B3', // MG 16 (밝게 조정)
            '#D1427F', // MG 17 (밝게 조정)
            '#2A6FB0', // MG 18 (밝게 조정)
            '#7A2FC4', // MG 19 (밝게 조정)
            '#33E5FF'  // MG 20 (밝게 조정)
        ];

        // 일별 노출인구 비교 차트 (주요 광고 성과 4-2)
        const dailyCtx = document.getElementById('chart-canvas-daily');
        const dailyAverageEl = document.getElementById('daily-chart-average');
        const dailyLegendEl = document.querySelector('.daily-chart-legend');
        
        if (dailyCtx) {
            // 서버 측에서 템플릿 변수를 실제 데이터로 치환해야 합니다
            // 미디어그룹별 색상은 미디어그룹컬러팔레트 배열에서 순서대로 가져옵니다
            // 예시 구조:
            // const 미디어그룹컬러팔레트 = ['#026E81', '#00ABBD', '#00349B', ...]; // 위에 정의됨
            // const 일별노출인구데이터 = {
            //     날짜리스트: ['2025.07.01', '2025.07.02', '2025.07.03', ...],
            //     미디어그룹리스트: [
            //         {
            //             미디어그룹명: '강남역 2호선 지하철 광고',
            //             일별데이터: [1200, 1500, 1800, ...],
            //             색상: 미디어그룹컬러팔레트[0] // 첫 번째 미디어그룹은 MG 1 색상
            //         },
            //         {
            //             미디어그룹명: '홍대입구역 빌딩',
            //             일별데이터: [800, 1000, 2800, ...],
            //             색상: 미디어그룹컬러팔레트[1] // 두 번째 미디어그룹은 MG 2 색상
            //         },
            //         {
            //             미디어그룹명: '시청역 빌딩',
            //             일별데이터: [1000, 1200, 3200, ...],
            //             색상: 미디어그룹컬러팔레트[2] // 세 번째 미디어그룹은 MG 3 색상
            //         }
            //         // 색상을 지정하지 않으면 자동으로 팔레트에서 순서대로 할당됩니다
            //     ],
            //     일평균: 2500
            // };
            // 
            // 서버 측 렌더링 예시 (Handlebars):
            // const 미디어그룹컬러팔레트 = ['#026E81', '#00ABBD', '#00349B', ...];
            // {{#each 미디어그룹리스트}}
            //   {
            //     미디어그룹명: '{{this.이름}}',
            //     일별데이터: [{{#each this.일별데이터}}{{this}}{{#unless @last}},{{/unless}}{{/each}}],
            //     색상: 미디어그룹컬러팔레트[{{@index}}] // 순서대로 색상 할당
            //   }{{#unless @last}},{{/unless}}
            // {{/each}}
            //
            // 서버 측 렌더링 예시 (Jinja2):
            // const 미디어그룹컬러팔레트 = ['#026E81', '#00ABBD', '#00349B', ...];
            // {% for item in 미디어그룹리스트 %}
            //   {
            //     미디어그룹명: '{{item.이름}}',
            //     일별데이터: [{{item.일별데이터|join(',')}}],
            //     색상: 미디어그룹컬러팔레트[{{loop.index0}}] // 순서대로 색상 할당
            //   }{% if not loop.last %},{% endif %}
            // {% endfor %}
            
            // 임시 데이터 (서버에서 위의 템플릿으로 치환)
            const 일별노출인구데이터 = {
                날짜리스트: ['07.01', '07.02', '07.03', '07.04', '07.05', '07.06', '07.07', '07.08', '07.09', '07.10', 
                             '07.11', '07.12', '07.13', '07.14', '07.15', '07.16', '07.17', '07.18', '07.19', '07.20',
                             '07.21', '07.22', '07.23', '07.24', '07.25', '07.26', '07.27', '07.28', '07.29', '07.30', '07.31'],
                미디어그룹리스트: [
                    {
                        미디어그룹명: '강남역 2호선 지하철 광고',
                        일별데이터: [1200, 1500, 1800, 1600, 1400, 1700, 1900, 2100, 2000, 1800,
                                     1600, 1500, 1700, 1900, 2100, 2000, 1800, 1600, 1500, 1700,
                                     1900, 2100, 2000, 1800, 1600, 1500, 1700, 1900, 2100, 2000, 1800],
                        색상: 미디어그룹컬러팔레트[0] // MG 1
                    },
                    {
                        미디어그룹명: '홍대입구역 빌딩',
                        일별데이터: [800, 1000, 2800, 1200, 1100, 1300, 1500, 1400, 1200, 1100,
                                     1000, 1200, 1400, 1500, 1300, 1200, 1100, 1000, 1200, 1400,
                                     1500, 1300, 1200, 1100, 1000, 1200, 1400, 1500, 1300, 1200, 1100],
                        색상: 미디어그룹컬러팔레트[1] // MG 2
                    },
                    {
                        미디어그룹명: '시청역 빌딩',
                        일별데이터: [1000, 1200, 3200, 1400, 1300, 1500, 1700, 1600, 1400, 1300,
                                     1200, 1400, 1600, 1700, 1500, 1400, 1300, 1200, 1400, 1600,
                                     1700, 1500, 1400, 1300, 1200, 1400, 1600, 1700, 1500, 1400, 1300],
                        색상: 미디어그룹컬러팔레트[2] // MG 3
                    }
                ],
                일평균: 2500
            };

            // 일 평균 노출인구 수를 가장 상단에 표시
            if (dailyAverageEl) {
                dailyAverageEl.textContent = `일 평균: ${일별노출인구데이터.일평균.toLocaleString()}명`;
            }

            // 각 날짜별 총합 계산
            const 날짜별총합 = 일별노출인구데이터.날짜리스트.map((날짜, 인덱스) => {
                return 일별노출인구데이터.미디어그룹리스트.reduce((합, 그룹) => 합 + 그룹.일별데이터[인덱스], 0);
            });

            // 총합이 가장 많은 날 찾기
            const 최대값인덱스 = 날짜별총합.indexOf(Math.max(...날짜별총합));
            const 최대총합값 = 날짜별총합[최대값인덱스];

            // 각 미디어그룹별 최대값 찾기
            const 미디어그룹별최대값 = 일별노출인구데이터.미디어그룹리스트.map(그룹 => {
                const 최대값 = Math.max(...그룹.일별데이터);
                const 최대값인덱스 = 그룹.일별데이터.indexOf(최대값);
                return { 그룹, 최대값, 최대값인덱스 };
            });

            // 범례 생성 (미디어그룹별 색상 순서대로 적용)
            if (dailyLegendEl) {
                일별노출인구데이터.미디어그룹리스트.forEach((그룹, index) => {
                    // 색상이 지정되지 않은 경우 팔레트에서 순서대로 가져오기
                    const 색상 = 그룹.색상 || 미디어그룹컬러팔레트[index % 미디어그룹컬러팔레트.length];
                    
                    const legendItem = document.createElement('div');
                    legendItem.className = 'legend-item';
                    
                    const legendIcon = document.createElement('div');
                    legendIcon.className = 'legend-icon';
                    legendIcon.style.backgroundColor = 색상;
                    legendItem.appendChild(legendIcon);
                    
                    const legendText = document.createElement('span');
                    legendText.className = 'legend-text';
                    legendText.textContent = 그룹.미디어그룹명;
                    legendItem.appendChild(legendText);
                    
                    dailyLegendEl.appendChild(legendItem);
                });

                // 평균 범례 추가
                const legendSeparator = document.createElement('div');
                legendSeparator.className = 'legend-separator';
                legendSeparator.innerHTML = '<svg width="20" height="1" viewBox="0 0 20 1"><line x1="0" y1="0.5" x2="20" y2="0.5" stroke="#626262" stroke-width="1"/></svg>';
                dailyLegendEl.appendChild(legendSeparator);

                const legendItemAvg = document.createElement('div');
                legendItemAvg.className = 'legend-item';
                const legendTextAvg = document.createElement('span');
                legendTextAvg.className = 'legend-text';
                legendTextAvg.textContent = '평균';
                legendItemAvg.appendChild(legendTextAvg);
                dailyLegendEl.appendChild(legendItemAvg);
            }

            // 차트 데이터셋 생성 (미디어그룹별 색상 순서대로 적용)
            const datasets = 일별노출인구데이터.미디어그룹리스트.map((그룹, index) => {
                const 최대값정보 = 미디어그룹별최대값[index];
                // 색상이 지정되지 않은 경우 팔레트에서 순서대로 가져오기
                const 색상 = 그룹.색상 || 미디어그룹컬러팔레트[index % 미디어그룹컬러팔레트.length];
                return {
                    label: 그룹.미디어그룹명,
                    data: 그룹.일별데이터,
                    backgroundColor: 색상,
                    borderColor: 색상,
                    borderWidth: 0,
                    maxValue: 최대값정보.최대값,
                    maxValueIndex: 최대값정보.최대값인덱스
                };
            });

            // 평균선 데이터셋 추가
            datasets.push({
                label: '평균',
                data: Array(일별노출인구데이터.날짜리스트.length).fill(일별노출인구데이터.일평균),
                type: 'line',
                borderColor: '#626262',
                borderWidth: 1,
                borderDash: [5, 5],
                fill: false,
                pointRadius: 0,
                pointHoverRadius: 0,
                tension: 0
            });

            const dailyChart = new Chart(dailyCtx, {
                type: 'bar',
                data: {
                    labels: 일별노출인구데이터.날짜리스트,
                    datasets: datasets
                },
                options: {
                    indexAxis: 'x',
                    scales: {
                        x: {
                            stacked: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#616161',
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#757575',
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            },
                            grid: {
                                display: true,
                                color: '#e0e0e0'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // 범례는 HTML로 별도 표시
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.parsed.y;
                                    return label + ': ' + value.toLocaleString() + '명';
                                }
                            },
                            titleFont: {
                                family: 'Pretendard',
                                size: 12
                            },
                            bodyFont: {
                                family: 'Pretendard',
                                size: 11
                            }
                        }
                    },
                    maintainAspectRatio: false,
                    responsive: true,
                    animation: {
                        onComplete: function() {
                            const ctx = dailyChart.ctx;
                            
                            // 모든 미디어그룹별로 각각 노출 인구 수가 가장 많은 날에 숫자를 기입
                            미디어그룹별최대값.forEach((정보, index) => {
                                const meta = dailyChart.getDatasetMeta(index);
                                
                                meta.data.forEach((bar, barIndex) => {
                                    if (barIndex === 정보.최대값인덱스) {
                                        const x = bar.x;
                                        // 누적된 높이 계산 (현재 미디어그룹 이전까지)
                                        let 누적높이 = 0;
                                        for (let i = 0; i < index; i++) {
                                            const prevMeta = dailyChart.getDatasetMeta(i);
                                            누적높이 += prevMeta.data[barIndex].height;
                                        }
                                        
                                        // 해당 미디어그룹 막대의 중앙에 숫자 표시
                                        const y = bar.y - 누적높이 - bar.height / 2;
                                        
                                        ctx.save();
                                        ctx.fillStyle = '#000000';
                                        ctx.font = '700 11px Pretendard';
                                        ctx.textAlign = 'center';
                                        ctx.textBaseline = 'middle';
                                        ctx.fillText(정보.최대값.toLocaleString() + '명', x, y);
                                        ctx.restore();
                                    }
                                });
                            });
                        }
                    }
                }
            });
        }

        // 요일별 노출인구 비교 차트 (주요 광고 성과 4-3)
        const weeklyCtx = document.getElementById('chart-canvas-weekly');
        const weeklyMaxValueEl = document.getElementById('weekly-chart-max-value');
        const weeklyLegendEl = document.querySelector('.weekly-chart-legend');
        
        if (weeklyCtx) {
            // 서버 측에서 템플릿 변수를 실제 데이터로 치환해야 합니다
            // 예시 구조:
            // const 요일별노출인구데이터 = {
            //     요일리스트: ['월', '화', '수', '목', '금', '토', '일'],
            //     미디어그룹리스트: [
            //         {
            //             미디어그룹명: '강남역 2호선 지하철 광고',
            //             요일별데이터: [8500, 9000, 9200, 8800, 9100, 7200, 6500], // 월~일
            //             색상: 미디어그룹컬러팔레트[0] // 순서대로 적용
            //         },
            //         {
            //             미디어그룹명: '홍대입구역 빌딩',
            //             요일별데이터: [6000, 6500, 6800, 6400, 6700, 5500, 4800],
            //             색상: 미디어그룹컬러팔레트[1]
            //         },
            //         {
            //             미디어그룹명: '시청역 빌딩',
            //             요일별데이터: [7500, 7800, 8000, 7700, 7900, 6200, 5500],
            //             색상: 미디어그룹컬러팔레트[2]
            //         }
            //     ],
            //     일평균: 8800 // 전체 미디어그룹의 요일별 일 평균 노출인구
            // };
            
            // 임시 데이터 (서버에서 위의 템플릿으로 치환)
            const 요일별노출인구데이터 = {
                요일리스트: ['월', '화', '수', '목', '금', '토', '일'],
                미디어그룹리스트: [
                    {
                        미디어그룹명: '강남역 2호선 지하철 광고',
                        요일별데이터: [8500, 9000, 9200, 8800, 9100, 7200, 6500],
                        색상: 미디어그룹컬러팔레트[0] // MG 1
                    },
                    {
                        미디어그룹명: '홍대입구역 빌딩',
                        요일별데이터: [6000, 6500, 6800, 6400, 6700, 5500, 4800],
                        색상: 미디어그룹컬러팔레트[1] // MG 2
                    },
                    {
                        미디어그룹명: '시청역 빌딩',
                        요일별데이터: [7500, 7800, 8000, 7700, 7900, 6200, 5500],
                        색상: 미디어그룹컬러팔레트[2] // MG 3
                    }
                ],
                일평균: 8800
            };

            // 각 요일별 총합 계산
            const 요일별총합 = 요일별노출인구데이터.요일리스트.map((요일, 인덱스) => {
                return 요일별노출인구데이터.미디어그룹리스트.reduce((합, 그룹) => 합 + 그룹.요일별데이터[인덱스], 0);
            });

            // 총합이 가장 많은 요일 찾기
            const 최대값인덱스 = 요일별총합.indexOf(Math.max(...요일별총합));
            const 최대총합값 = 요일별총합[최대값인덱스];
            const 최대요일 = 요일별노출인구데이터.요일리스트[최대값인덱스];

            // 최대값 표시 (차트 상단에 표시되도록 주석 처리, 차트 내부에 표시)
            // if (weeklyMaxValueEl) {
            //     weeklyMaxValueEl.textContent = `평균 ${최대총합값.toLocaleString()} 명`;
            // }

            // 각 미디어그룹별 최대값 찾기
            const 미디어그룹별최대값 = 요일별노출인구데이터.미디어그룹리스트.map(그룹 => {
                const 최대값 = Math.max(...그룹.요일별데이터);
                const 최대값인덱스 = 그룹.요일별데이터.indexOf(최대값);
                return { 그룹, 최대값, 최대값인덱스 };
            });

            // 범례 생성
            if (weeklyLegendEl) {
                요일별노출인구데이터.미디어그룹리스트.forEach((그룹, index) => {
                    // 색상이 지정되지 않은 경우 팔레트에서 순서대로 가져오기
                    const 색상 = 그룹.색상 || 미디어그룹컬러팔레트[index % 미디어그룹컬러팔레트.length];
                    
                    const legendItem = document.createElement('div');
                    legendItem.className = 'legend-item';
                    
                    const legendIcon = document.createElement('div');
                    legendIcon.className = 'legend-icon';
                    legendIcon.style.backgroundColor = 색상;
                    legendItem.appendChild(legendIcon);
                    
                    const legendText = document.createElement('span');
                    legendText.className = 'legend-text';
                    legendText.textContent = 그룹.미디어그룹명;
                    legendItem.appendChild(legendText);
                    
                    weeklyLegendEl.appendChild(legendItem);
                });

                // 일평균 범례 추가
                const legendSeparator = document.createElement('div');
                legendSeparator.className = 'legend-separator';
                legendSeparator.innerHTML = '<svg width="20" height="1" viewBox="0 0 20 1"><line x1="0" y1="0.5" x2="20" y2="0.5" stroke="#626262" stroke-width="1"/></svg>';
                weeklyLegendEl.appendChild(legendSeparator);

                const legendItemAvg = document.createElement('div');
                legendItemAvg.className = 'legend-item';
                const legendTextAvg = document.createElement('span');
                legendTextAvg.className = 'legend-text';
                legendTextAvg.textContent = '일평균 노출인구수';
                legendItemAvg.appendChild(legendTextAvg);
                weeklyLegendEl.appendChild(legendItemAvg);
            }

            // 차트 데이터셋 생성 (누적 막대그래프)
            const datasets = 요일별노출인구데이터.미디어그룹리스트.map((그룹, index) => {
                const 최대값정보 = 미디어그룹별최대값[index];
                // 색상이 지정되지 않은 경우 팔레트에서 순서대로 가져오기
                const 색상 = 그룹.색상 || 미디어그룹컬러팔레트[index % 미디어그룹컬러팔레트.length];
                return {
                    label: 그룹.미디어그룹명,
                    data: 그룹.요일별데이터,
                    backgroundColor: 색상,
                    borderColor: 색상,
                    borderWidth: 0,
                    maxValue: 최대값정보.최대값,
                    maxValueIndex: 최대값정보.최대값인덱스
                };
            });

            // 일평균선 데이터셋 추가 (꺾은선) - 전체 미디어그룹의 요일별 일 평균 노출인구
            // 요일별로 각 미디어그룹의 평균을 계산
            const 요일별일평균 = 요일별노출인구데이터.요일리스트.map((요일, 인덱스) => {
                // 각 요일별로 모든 미디어그룹의 평균값 계산
                const 요일별합계 = 요일별노출인구데이터.미디어그룹리스트.reduce((합, 그룹) => 합 + 그룹.요일별데이터[인덱스], 0);
                return 요일별합계 / 요일별노출인구데이터.미디어그룹리스트.length;
            });
            
            datasets.unshift({
                label: '일평균 노출인구수',
                data: 요일별일평균,
                type: 'line',
                borderColor: '#008aff',
                borderWidth: 2,
                borderDash: [],
                fill: false,
                pointRadius: 0,
                pointHoverRadius: 0,
                tension: 0,
                order: 1 // 선을 막대 뒤에 그리기
            });

            const weeklyChart = new Chart(weeklyCtx, {
                type: 'bar',
                data: {
                    labels: 요일별노출인구데이터.요일리스트,
                    datasets: datasets
                },
                options: {
                    indexAxis: 'x',
                    scales: {
                        x: {
                            stacked: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 12
                                },
                                color: '#616161',
                                maxRotation: 0,
                                minRotation: 0
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#757575',
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            },
                            grid: {
                                display: true,
                                color: '#e0e0e0'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // 범례는 HTML로 별도 표시
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.parsed.y;
                                    return label + ': ' + value.toLocaleString() + '명';
                                }
                            },
                            titleFont: {
                                family: 'Pretendard',
                                size: 12
                            },
                            bodyFont: {
                                family: 'Pretendard',
                                size: 11
                            }
                        }
                    },
                    maintainAspectRatio: false,
                    responsive: true,
                    animation: {
                        onComplete: function() {
                            const ctx = weeklyChart.ctx;
                            
                            // 1. 일 평균 노출인구 수 총합이 가장 높은 요일의 값을 막대 상단에 표시
                            const 최대총합요일인덱스 = 최대값인덱스;
                            const 최대총합요일막대 = weeklyChart.getDatasetMeta(1).data[최대총합요일인덱스]; // 첫 번째 막대 데이터셋 (일평균선 다음)
                            
                            if (최대총합요일막대) {
                                // 모든 미디어그룹 막대의 누적 높이 계산
                                let 총누적높이 = 0;
                                for (let i = 1; i < datasets.length; i++) { // 일평균선 제외
                                    const meta = weeklyChart.getDatasetMeta(i);
                                    if (meta.data[최대총합요일인덱스]) {
                                        총누적높이 += meta.data[최대총합요일인덱스].height;
                                    }
                                }
                                
                                const x = 최대총합요일막대.x;
                                const y = 최대총합요일막대.y - 총누적높이 - 10; // 막대 상단에 10px 여백
                                
                                ctx.save();
                                ctx.fillStyle = '#000000';
                                ctx.font = '700 11px Pretendard';
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'bottom';
                                ctx.fillText(`총 ${최대총합값.toLocaleString()}명`, x, y);
                                ctx.restore();
                            }
                            
                            // 2. 각 미디어그룹별로 일 평균 노출인구 수가 가장 많은 요일의 값을 해당 막대에 표시
                            미디어그룹별최대값.forEach((정보, index) => {
                                // 일평균선이 첫 번째이므로 index + 1
                                const meta = weeklyChart.getDatasetMeta(index + 1);
                                
                                meta.data.forEach((bar, barIndex) => {
                                    if (barIndex === 정보.최대값인덱스) {
                                        const x = bar.x;
                                        // 누적된 높이 계산 (현재 미디어그룹 이전까지)
                                        let 누적높이 = 0;
                                        for (let i = 1; i <= index; i++) { // 일평균선 제외
                                            const prevMeta = weeklyChart.getDatasetMeta(i);
                                            누적높이 += prevMeta.data[barIndex].height;
                                        }
                                        
                                        // 해당 미디어그룹 막대의 중앙에 숫자 표시
                                        const y = bar.y - 누적높이 - bar.height / 2;
                                        
                                        // 텍스트 크기 측정
                                        ctx.save();
                                        ctx.font = '700 11px Pretendard';
                                        const text = 정보.최대값.toLocaleString() + '명';
                                        const textMetrics = ctx.measureText(text);
                                        const textWidth = textMetrics.width;
                                        
                                        // 막대 너비 확인 (막대가 텍스트보다 넓은지 확인)
                                        const barWidth = Math.abs(bar.width);
                                        
                                        // 막대 안에 들어갈 수 있는 경우에만 표시
                                        if (textWidth < barWidth - 4) { // 양쪽 2px씩 여백
                                            ctx.fillStyle = '#000000';
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'middle';
                                            ctx.fillText(text, x, y);
                                        }
                                        ctx.restore();
                                    }
                                });
                            });
                        }
                    }
                }
            });
        }

        // 시간대별 노출인구 비교 차트 (주요 광고 성과 4-4)
        const hourlyCtx = document.getElementById('chart-canvas-hourly');
        const hourlyMaxValueEl = document.getElementById('hourly-chart-max-value');
        const hourlyLegendEl = document.querySelector('.hourly-chart-legend');
        
        if (hourlyCtx) {
            // 서버 측에서 템플릿 변수를 실제 데이터로 치환해야 합니다
            // 예시 구조:
            // const 시간대별노출인구데이터 = {
            //     시간대리스트: ['09시', '10시', '11시', '12시', '13시', '14시', '15시', '16시', '17시', '18시', '19시', '20시', '21시', '22시'],
            //     미디어그룹리스트: [
            //         {
            //             미디어그룹명: '강남역 2호선 지하철 광고',
            //             시간대별데이터: [2400, 2800, 3200, 3800, 3500, 3300, 3400, 3600, 4000, 4200, 3800, 3200, 2800, 2400],
            //             색상: 미디어그룹컬러팔레트[0] // 순서대로 적용
            //         },
            //         {
            //             미디어그룹명: '홍대입구역 빌딩',
            //             시간대별데이터: [1800, 2100, 2400, 2800, 2600, 2500, 2600, 2700, 3000, 3200, 2900, 2400, 2100, 1800],
            //             색상: 미디어그룹컬러팔레트[1]
            //         },
            //         {
            //             미디어그룹명: '시청역 빌딩',
            //             시간대별데이터: [2000, 2300, 2700, 3200, 3000, 2900, 3000, 3100, 3400, 3600, 3300, 2800, 2400, 2000],
            //             색상: 미디어그룹컬러팔레트[2]
            //         }
            //     ],
            //     시간대평균: 8800 // 전체 미디어그룹의 시간대별 평균 노출인구
            // };
            
            // 임시 데이터 (서버에서 위의 템플릿으로 치환)
            const 시간대별노출인구데이터 = {
                시간대리스트: ['09시', '10시', '11시', '12시', '13시', '14시', '15시', '16시', '17시', '18시', '19시', '20시', '21시', '22시'],
                미디어그룹리스트: [
                    {
                        미디어그룹명: '강남역 2호선 지하철 광고',
                        시간대별데이터: [2400, 2800, 3200, 3800, 3500, 3300, 3400, 3600, 4000, 4200, 3800, 3200, 2800, 2400],
                        색상: 미디어그룹컬러팔레트[0] // MG 1
                    },
                    {
                        미디어그룹명: '홍대입구역 빌딩',
                        시간대별데이터: [1800, 2100, 2400, 2800, 2600, 2500, 2600, 2700, 3000, 3200, 2900, 2400, 2100, 1800],
                        색상: 미디어그룹컬러팔레트[1] // MG 2
                    },
                    {
                        미디어그룹명: '시청역 빌딩',
                        시간대별데이터: [2000, 2300, 2700, 3200, 3000, 2900, 3000, 3100, 3400, 3600, 3300, 2800, 2400, 2000],
                        색상: 미디어그룹컬러팔레트[2] // MG 3
                    }
                ],
                시간대평균: 8800
            };

            // 각 시간대별 총합 계산
            const 시간대별총합 = 시간대별노출인구데이터.시간대리스트.map((시간대, 인덱스) => {
                return 시간대별노출인구데이터.미디어그룹리스트.reduce((합, 그룹) => 합 + 그룹.시간대별데이터[인덱스], 0);
            });

            // 총합이 가장 많은 시간대 찾기
            const 최대값인덱스 = 시간대별총합.indexOf(Math.max(...시간대별총합));
            const 최대총합값 = 시간대별총합[최대값인덱스];
            const 최대시간대 = 시간대별노출인구데이터.시간대리스트[최대값인덱스];

            // 최대값 표시
            if (hourlyMaxValueEl) {
                hourlyMaxValueEl.textContent = `평균 ${최대총합값.toLocaleString()} 명`;
            }

            // 각 미디어그룹별 최대값 찾기
            const 미디어그룹별최대값 = 시간대별노출인구데이터.미디어그룹리스트.map(그룹 => {
                const 최대값 = Math.max(...그룹.시간대별데이터);
                const 최대값인덱스 = 그룹.시간대별데이터.indexOf(최대값);
                return { 그룹, 최대값, 최대값인덱스 };
            });

            // 범례 생성
            if (hourlyLegendEl) {
                시간대별노출인구데이터.미디어그룹리스트.forEach((그룹, index) => {
                    // 색상이 지정되지 않은 경우 팔레트에서 순서대로 가져오기
                    const 색상 = 그룹.색상 || 미디어그룹컬러팔레트[index % 미디어그룹컬러팔레트.length];
                    
                    const legendItem = document.createElement('div');
                    legendItem.className = 'legend-item';
                    
                    const legendIcon = document.createElement('div');
                    legendIcon.className = 'legend-icon';
                    legendIcon.style.backgroundColor = 색상;
                    legendItem.appendChild(legendIcon);
                    
                    const legendText = document.createElement('span');
                    legendText.className = 'legend-text';
                    legendText.textContent = 그룹.미디어그룹명;
                    legendItem.appendChild(legendText);
                    
                    hourlyLegendEl.appendChild(legendItem);
                });

                // 시간대 평균 범례 추가
                const legendSeparator = document.createElement('div');
                legendSeparator.className = 'legend-separator';
                legendSeparator.innerHTML = '<svg width="20" height="1" viewBox="0 0 20 1"><line x1="0" y1="0.5" x2="20" y2="0.5" stroke="#626262" stroke-width="1"/></svg>';
                hourlyLegendEl.appendChild(legendSeparator);

                const legendItemAvg = document.createElement('div');
                legendItemAvg.className = 'legend-item';
                const legendTextAvg = document.createElement('span');
                legendTextAvg.className = 'legend-text';
                legendTextAvg.textContent = '시간대 평균 노출인구수';
                legendItemAvg.appendChild(legendTextAvg);
                hourlyLegendEl.appendChild(legendItemAvg);
            }

            // 차트 데이터셋 생성 (누적 꺾은선 그래프)
            // 각 미디어그룹의 데이터를 누적 계산
            const 누적데이터 = [];
            시간대별노출인구데이터.미디어그룹리스트.forEach((그룹, index) => {
                if (index === 0) {
                    // 첫 번째 그룹은 그대로
                    누적데이터.push([...그룹.시간대별데이터]);
                } else {
                    // 이전 그룹들의 누적값에 현재 그룹 데이터 추가
                    const 이전누적 = 누적데이터[index - 1];
                    누적데이터.push(이전누적.map((값, i) => 값 + 그룹.시간대별데이터[i]));
                }
            });
            
            const datasets = 시간대별노출인구데이터.미디어그룹리스트.map((그룹, index) => {
                const 최대값정보 = 미디어그룹별최대값[index];
                // 색상이 지정되지 않은 경우 팔레트에서 순서대로 가져오기
                const 색상 = 그룹.색상 || 미디어그룹컬러팔레트[index % 미디어그룹컬러팔레트.length];
                return {
                    label: 그룹.미디어그룹명,
                    data: 누적데이터[index], // 누적된 데이터 사용
                    backgroundColor: 색상 + '80', // 투명도 추가
                    borderColor: 색상,
                    borderWidth: 2,
                    fill: index === 0 ? true : '-1', // 첫 번째는 0부터, 나머지는 이전 데이터셋 위에
                    tension: 0.4, // 부드러운 곡선
                    maxValue: 최대값정보.최대값,
                    maxValueIndex: 최대값정보.최대값인덱스
                };
            });

            // 시간대 평균선 데이터셋 추가 (보조선)
            datasets.push({
                label: '시간대 평균 노출인구수',
                data: Array(시간대별노출인구데이터.시간대리스트.length).fill(시간대별노출인구데이터.시간대평균),
                type: 'line',
                borderColor: '#008aff',
                borderWidth: 2,
                borderDash: [5, 5],
                fill: false,
                pointRadius: 0,
                pointHoverRadius: 0,
                tension: 0,
                order: 0 // 선을 막대 뒤에 그리기
            });

            const hourlyChart = new Chart(hourlyCtx, {
                type: 'line',
                data: {
                    labels: 시간대별노출인구데이터.시간대리스트,
                    datasets: datasets
                },
                options: {
                    indexAxis: 'x',
                    scales: {
                        x: {
                            stacked: true, // 누적 그래프
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#616161',
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            stacked: false, // 수동으로 누적 계산했으므로 false
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#757575',
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            },
                            grid: {
                                display: true,
                                color: '#e0e0e0'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // 범례는 HTML로 별도 표시
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.parsed.y;
                                    return label + ': ' + value.toLocaleString() + '명';
                                }
                            },
                            titleFont: {
                                family: 'Pretendard',
                                size: 12
                            },
                            bodyFont: {
                                family: 'Pretendard',
                                size: 11
                            }
                        }
                    },
                    maintainAspectRatio: false,
                    responsive: true,
                    animation: {
                        onComplete: function() {
                            // 각 미디어그룹별 최대값에 라벨 표시
                            const ctx = hourlyChart.ctx;
                            미디어그룹별최대값.forEach((정보, index) => {
                                const meta = hourlyChart.getDatasetMeta(index);
                                if (meta && meta.data && meta.data[정보.최대값인덱스]) {
                                    const point = meta.data[정보.최대값인덱스];
                                    const x = point.x;
                                    // 누적된 높이 계산
                                    let 누적높이 = 0;
                                    for (let i = 0; i < index; i++) {
                                        const prevMeta = hourlyChart.getDatasetMeta(i);
                                        if (prevMeta && prevMeta.data && prevMeta.data[정보.최대값인덱스]) {
                                            const prevPoint = prevMeta.data[정보.최대값인덱스];
                                            누적높이 += prevPoint.y;
                                        }
                                    }
                                    const y = point.y - 누적높이;
                                    
                                    ctx.save();
                                    ctx.fillStyle = '#000000';
                                    ctx.font = '400 11px Pretendard';
                                    ctx.textAlign = 'center';
                                    ctx.textBaseline = 'bottom';
                                    ctx.fillText(정보.최대값.toLocaleString() + '명', x, y - 5);
                                    ctx.restore();
                                }
                            });
                            
                            // 누적 합계가 가장 높은 시간대 강조 (배경색 추가)
                            const maxTotalMeta = hourlyChart.getDatasetMeta(시간대별노출인구데이터.미디어그룹리스트.length - 1);
                            if (maxTotalMeta && maxTotalMeta.data && maxTotalMeta.data[최대값인덱스]) {
                                const maxPoint = maxTotalMeta.data[최대값인덱스];
                                const x = maxPoint.x;
                                const y = maxPoint.y;
                                
                                // 강조 박스 그리기
                                ctx.save();
                                ctx.fillStyle = 'rgba(182, 167, 255, 0.5)';
                                ctx.strokeStyle = '#6f47ff';
                                ctx.lineWidth = 1;
                                ctx.fillRect(x - 38, 0, 76, y);
                                ctx.strokeRect(x - 38, 0, 76, y);
                                ctx.restore();
                            }
                        }
                    }
                }
            });
        }

        // 노출 효과 시각화 차트 (페이지 15)
        // 연령・성별 분포 차트 (피라미드)
        const visualizationPyramidCtx = document.getElementById('chart-canvas-mediagroup-ots-pyramid');
        const visualizationPyramidLegendEl = document.querySelector('.frame-visualization-age-gender .visualization-legend-age-gender');
        
        if (visualizationPyramidCtx) {
            // 서버 측에서 템플릿 변수를 실제 데이터로 치환해야 합니다
            // 예시 구조:
            // const 연령대별데이터 = [
            //     { 연령대: '10-14세', 남성: 120, 여성: 110 },
            //     { 연령대: '15-19세', 남성: 150, 여성: 140 },
            //     { 연령대: '20-24세', 남성: 200, 여성: 180 },
            //     { 연령대: '25-29세', 남성: 180, 여성: 190 },
            //     { 연령대: '30대', 남성: 4200, 여성: 4600 },
            //     { 연령대: '40대', 남성: 150, 여성: 160 },
            //     { 연령대: '50대', 남성: 100, 여성: 120 },
            //     { 연령대: '60대', 남성: 80, 여성: 90 },
            //     { 연령대: '70대 이상', 남성: 50, 여성: 60 }
            // ];
            
            // 임시 데이터 (서버에서 위의 템플릿으로 치환)
            const 연령대별데이터 = [
                { 연령대: '10-14세', 남성: 120, 여성: 110 },
                { 연령대: '15-19세', 남성: 150, 여성: 140 },
                { 연령대: '20-24세', 남성: 200, 여성: 180 },
                { 연령대: '25-29세', 남성: 180, 여성: 190 },
                { 연령대: '30대', 남성: 4200, 여성: 4600 },
                { 연령대: '40대', 남성: 150, 여성: 160 },
                { 연령대: '50대', 남성: 100, 여성: 120 },
                { 연령대: '60대', 남성: 80, 여성: 90 },
                { 연령대: '70대 이상', 남성: 50, 여성: 60 }
            ];

            // 범례 생성
            if (visualizationPyramidLegendEl) {
                // 남성 범례
                const maleLegendItem = document.createElement('div');
                maleLegendItem.className = 'legend-item';
                const maleIcon = document.createElement('div');
                maleIcon.className = 'legend-icon legend-male';
                const maleText = document.createElement('span');
                maleText.className = 'legend-text';
                maleText.textContent = '남성';
                maleLegendItem.appendChild(maleIcon);
                maleLegendItem.appendChild(maleText);
                
                // 여성 범례
                const femaleLegendItem = document.createElement('div');
                femaleLegendItem.className = 'legend-item';
                const femaleIcon = document.createElement('div');
                femaleIcon.className = 'legend-icon legend-female';
                const femaleText = document.createElement('span');
                femaleText.className = 'legend-text';
                femaleText.textContent = '여성';
                femaleLegendItem.appendChild(femaleIcon);
                femaleLegendItem.appendChild(femaleText);
                
                visualizationPyramidLegendEl.appendChild(maleLegendItem);
                visualizationPyramidLegendEl.appendChild(femaleLegendItem);
            }

            // 최대값 계산
            const maxValue = Math.max(
                ...연령대별데이터.map(item => Math.max(item.남성, item.여성))
            );

            // 연령대 라벨
            const 연령대라벨 = 연령대별데이터.map(item => item.연령대);

            // 차트 데이터 준비
            const 남성데이터 = 연령대별데이터.map(item => -item.남성); // 음수로 왼쪽에 표시
            const 여성데이터 = 연령대별데이터.map(item => item.여성); // 양수로 오른쪽에 표시

            // 남성 최대값 찾기
            const 남성최대값 = Math.max(...남성데이터.map(v => Math.abs(v)));
            const 남성최대값인덱스 = 남성데이터.findIndex(v => Math.abs(v) === 남성최대값);

            // 여성 최대값 찾기
            const 여성최대값 = Math.max(...여성데이터);
            const 여성최대값인덱스 = 여성데이터.findIndex(v => v === 여성최대값);

            // 차트 생성
            const visualizationPyramidChart = new Chart(visualizationPyramidCtx, {
                type: 'bar',
                data: {
                    labels: 연령대라벨,
                    datasets: [
                        {
                            label: '남성',
                            data: 남성데이터,
                            backgroundColor: '#4DADFF',
                            borderColor: '#4DADFF',
                            borderWidth: 0
                        },
                        {
                            label: '여성',
                            data: 여성데이터,
                            backgroundColor: '#FFA462',
                            borderColor: '#FFA462',
                            borderWidth: 0
                        }
                    ]
                },
                options: {
                    indexAxis: 'y',
                    datasets: {
                        bar: {
                            barThickness: 'flex',
                            categoryPercentage: 0.8,
                            barPercentage: 0.9
                        }
                    },
                    scales: {
                        x: {
                            stacked: false,
                            beginAtZero: true,
                            max: maxValue,
                            min: -maxValue,
                            ticks: {
                                callback: function(value) {
                                    return Math.abs(value);
                                },
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#757575'
                            },
                            grid: {
                                display: true,
                                color: '#e0e0e0'
                            }
                        },
                        y: {
                            stacked: false,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#616161'
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = Math.abs(context.parsed.x);
                                    return label + ': ' + value + '명';
                                }
                            },
                            titleFont: {
                                family: 'Pretendard',
                                size: 12
                            },
                            bodyFont: {
                                family: 'Pretendard',
                                size: 11
                            }
                        }
                    },
                    maintainAspectRatio: false,
                    responsive: true,
                    animation: {
                        onComplete: function() {
                            const ctx = visualizationPyramidChart.ctx;
                            
                            // 남성 최대값 표시
                            if (남성최대값인덱스 >= 0) {
                                const 남성Meta = visualizationPyramidChart.getDatasetMeta(0);
                                const 남성막대 = 남성Meta.data[남성최대값인덱스];
                                
                                if (남성막대) {
                                    const x = 남성막대.x;
                                    const y = 남성막대.y;
                                    
                                    ctx.save();
                                    ctx.font = '700 11px Pretendard';
                                    const text = 남성최대값.toLocaleString() + '명';
                                    const textMetrics = ctx.measureText(text);
                                    const textWidth = textMetrics.width;
                                    const barWidth = Math.abs(남성막대.width);
                                    
                                    if (textWidth < barWidth - 4) {
                                        ctx.fillStyle = '#000000';
                                        ctx.textAlign = 'center';
                                        ctx.textBaseline = 'middle';
                                        ctx.fillText(text, x, y);
                                    }
                                    ctx.restore();
                                }
                            }
                            
                            // 여성 최대값 표시
                            if (여성최대값인덱스 >= 0) {
                                const 여성Meta = visualizationPyramidChart.getDatasetMeta(1);
                                const 여성막대 = 여성Meta.data[여성최대값인덱스];
                                
                                if (여성막대) {
                                    const x = 여성막대.x;
                                    const y = 여성막대.y;
                                    
                                    ctx.save();
                                    ctx.font = '700 11px Pretendard';
                                    const text = 여성최대값.toLocaleString() + '명';
                                    const textMetrics = ctx.measureText(text);
                                    const textWidth = textMetrics.width;
                                    const barWidth = Math.abs(여성막대.width);
                                    
                                    if (textWidth < barWidth - 4) {
                                        ctx.fillStyle = '#000000';
                                        ctx.textAlign = 'center';
                                        ctx.textBaseline = 'middle';
                                        ctx.fillText(text, x, y);
                                    }
                                    ctx.restore();
                                }
                            }
                        }
                    }
                }
            });
        }

        // 일별 노출인구 차트 (페이지 15)
        const visualizationDailyCtx = document.getElementById('chart-canvas-mediagroup-ots-daily');
        const visualizationDailyTotalEl = document.getElementById('daily-chart-total-visualization');
        const visualizationDailyLegendEl = document.querySelector('.frame-visualization-daily .visualization-legend-daily');
        
        if (visualizationDailyCtx) {
            // 서버 측에서 템플릿 변수를 실제 데이터로 치환해야 합니다
            // 예시 구조:
            // const 일별노출인구데이터 = {
            //     날짜리스트: ['07.01', '07.02', '07.03', ...],
            //     일별데이터: [1200, 1500, 1800, ...]
            // };
            
            // 임시 데이터 (서버에서 위의 템플릿으로 치환)
            const 일별노출인구데이터 = {
                날짜리스트: ['07.01', '07.02', '07.03', '07.04', '07.05', '07.06', '07.07', '07.08', '07.09', '07.10', 
                             '07.11', '07.12', '07.13', '07.14', '07.15', '07.16', '07.17', '07.18', '07.19', '07.20',
                             '07.21', '07.22', '07.23', '07.24', '07.25', '07.26', '07.27', '07.28', '07.29', '07.30', '07.31'],
                일별데이터: [1200, 1500, 1800, 1600, 1400, 1700, 1900, 2100, 2000, 1800,
                             1600, 1500, 1700, 1900, 2100, 2000, 1800, 1600, 1500, 1700,
                             1900, 2100, 2000, 1800, 1600, 1500, 1700, 1900, 2100, 2000, 1800]
            };

            // 최대값 찾기
            const 최대값 = Math.max(...일별노출인구데이터.일별데이터);
            const 최대값인덱스 = 일별노출인구데이터.일별데이터.indexOf(최대값);
            const 최대날짜 = 일별노출인구데이터.날짜리스트[최대값인덱스];

            // 총합이 가장 많은 날의 값 표시
            if (visualizationDailyTotalEl) {
                visualizationDailyTotalEl.textContent = `총 ${최대값.toLocaleString()}명`;
            }

            // 범례 생성
            if (visualizationDailyLegendEl) {
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                
                const legendIcon = document.createElement('div');
                legendIcon.className = 'legend-icon';
                legendIcon.style.backgroundColor = '#4DADFF';
                legendItem.appendChild(legendIcon);
                
                const legendText = document.createElement('span');
                legendText.className = 'legend-text';
                legendText.textContent = '노출인구';
                legendItem.appendChild(legendText);
                
                visualizationDailyLegendEl.appendChild(legendItem);
            }

            // 차트 생성
            const visualizationDailyChart = new Chart(visualizationDailyCtx, {
                type: 'bar',
                data: {
                    labels: 일별노출인구데이터.날짜리스트,
                    datasets: [{
                        label: '노출인구',
                        data: 일별노출인구데이터.일별데이터,
                        backgroundColor: '#4DADFF',
                        borderColor: '#4DADFF',
                        borderWidth: 0
                    }]
                },
                options: {
                    indexAxis: 'x',
                    scales: {
                        x: {
                            stacked: false,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#616161'
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#757575',
                                callback: function(value) {
                                    return value.toLocaleString() + '명';
                                }
                            },
                            grid: {
                                display: true,
                                color: '#e0e0e0'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.y;
                                    return '노출인구: ' + value.toLocaleString() + '명';
                                }
                            },
                            titleFont: {
                                family: 'Pretendard',
                                size: 12
                            },
                            bodyFont: {
                                family: 'Pretendard',
                                size: 11
                            }
                        }
                    },
                    maintainAspectRatio: false,
                    responsive: true,
                    animation: {
                        onComplete: function() {
                            const ctx = visualizationDailyChart.ctx;
                            
                            // 최대값 막대 안에 표시
                            if (최대값인덱스 >= 0) {
                                const meta = visualizationDailyChart.getDatasetMeta(0);
                                const 막대 = meta.data[최대값인덱스];
                                
                                if (막대) {
                                    const x = 막대.x;
                                    const y = 막대.y;
                                    
                                    ctx.save();
                                    ctx.font = '700 11px Pretendard';
                                    const text = 최대값.toLocaleString() + '명';
                                    const textMetrics = ctx.measureText(text);
                                    const textWidth = textMetrics.width;
                                    const barHeight = Math.abs(막대.height);
                                    
                                    if (textWidth < barHeight - 4) {
                                        ctx.fillStyle = '#000000';
                                        ctx.textAlign = 'center';
                                        ctx.textBaseline = 'middle';
                                        ctx.fillText(text, x, y);
                                    }
                                    ctx.restore();
                                }
                            }
                        }
                    }
                }
            });
        }

        // 요일별 노출인구 차트 (페이지 16)
        const visualizationWeeklyCtx = document.getElementById('chart-canvas-mediagroup-ots-weekly');
        const visualizationWeeklyMaxValueEl = document.getElementById('weekly-chart-max-value-visualization');
        const visualizationWeeklyLegendEl = document.querySelector('.visualization-legend-weekly');
        
        if (visualizationWeeklyCtx) {
            // 서버 측에서 템플릿 변수를 실제 데이터로 치환해야 합니다
            // 예시 구조:
            // const 요일별노출인구데이터 = {
            //     요일리스트: ['월', '화', '수', '목', '금', '토', '일'],
            //     미디어그룹리스트: [
            //         {
            //             미디어그룹명: '강남역 2호선 지하철 광고',
            //             요일별데이터: [8500, 9000, 9200, 8800, 9100, 7200, 6500],
            //             색상: 미디어그룹컬러팔레트[0]
            //         },
            //         ...
            //     ],
            //     일평균: 8800
            // };
            
            // 임시 데이터 (서버에서 위의 템플릿으로 치환)
            const 요일별노출인구데이터 = {
                요일리스트: ['월', '화', '수', '목', '금', '토', '일'],
                미디어그룹리스트: [
                    {
                        미디어그룹명: '{{미디어그룹명1}}',
                        요일별데이터: [8500, 9000, 9200, 8800, 9100, 7200, 6500],
                        색상: 미디어그룹컬러팔레트[0]
                    },
                    {
                        미디어그룹명: '{{미디어그룹명2}}',
                        요일별데이터: [6000, 6500, 6800, 6400, 6700, 5500, 4800],
                        색상: 미디어그룹컬러팔레트[1]
                    },
                    {
                        미디어그룹명: '{{미디어그룹명3}}',
                        요일별데이터: [7500, 7800, 8000, 7700, 7900, 6200, 5500],
                        색상: 미디어그룹컬러팔레트[2]
                    }
                ],
                일평균: 8800
            };

            // 각 요일별 총합 계산
            const 요일별총합 = 요일별노출인구데이터.요일리스트.map((요일, 인덱스) => {
                return 요일별노출인구데이터.미디어그룹리스트.reduce((합, 그룹) => 합 + 그룹.요일별데이터[인덱스], 0);
            });

            // 총합이 가장 많은 요일 찾기
            const 최대값인덱스 = 요일별총합.indexOf(Math.max(...요일별총합));
            const 최대총합값 = 요일별총합[최대값인덱스];
            const 최대요일 = 요일별노출인구데이터.요일리스트[최대값인덱스];

            // 각 미디어그룹별 최대값 찾기
            const 미디어그룹별최대값 = 요일별노출인구데이터.미디어그룹리스트.map(그룹 => {
                const 최대값 = Math.max(...그룹.요일별데이터);
                const 최대값인덱스 = 그룹.요일별데이터.indexOf(최대값);
                return { 그룹, 최대값, 최대값인덱스 };
            });

            // 범례 생성
            if (visualizationWeeklyLegendEl) {
                요일별노출인구데이터.미디어그룹리스트.forEach((그룹, index) => {
                    const 색상 = 그룹.색상 || 미디어그룹컬러팔레트[index % 미디어그룹컬러팔레트.length];
                    
                    const legendItem = document.createElement('div');
                    legendItem.className = 'legend-item';
                    
                    const legendIcon = document.createElement('div');
                    legendIcon.className = 'legend-icon';
                    legendIcon.style.backgroundColor = 색상;
                    legendItem.appendChild(legendIcon);
                    
                    const legendText = document.createElement('span');
                    legendText.className = 'legend-text';
                    legendText.textContent = 그룹.미디어그룹명;
                    legendItem.appendChild(legendText);
                    
                    visualizationWeeklyLegendEl.appendChild(legendItem);
                });

                // 일평균 범례 추가
                const legendSeparator = document.createElement('div');
                legendSeparator.className = 'legend-separator';
                legendSeparator.innerHTML = '<svg width="20" height="1" viewBox="0 0 20 1"><line x1="0" y1="0.5" x2="20" y2="0.5" stroke="#626262" stroke-width="1"/></svg>';
                visualizationWeeklyLegendEl.appendChild(legendSeparator);

                const legendItemAvg = document.createElement('div');
                legendItemAvg.className = 'legend-item';
                const legendTextAvg = document.createElement('span');
                legendTextAvg.className = 'legend-text';
                legendTextAvg.textContent = '일평균 노출인구수';
                legendItemAvg.appendChild(legendTextAvg);
                visualizationWeeklyLegendEl.appendChild(legendItemAvg);
            }

            // 차트 데이터셋 생성 (누적 막대그래프)
            const datasets = 요일별노출인구데이터.미디어그룹리스트.map((그룹, index) => {
                const 최대값정보 = 미디어그룹별최대값[index];
                const 색상 = 그룹.색상 || 미디어그룹컬러팔레트[index % 미디어그룹컬러팔레트.length];
                return {
                    label: 그룹.미디어그룹명,
                    data: 그룹.요일별데이터,
                    backgroundColor: 색상,
                    borderColor: 색상,
                    borderWidth: 0,
                    maxValue: 최대값정보.최대값,
                    maxValueIndex: 최대값정보.최대값인덱스
                };
            });

            // 일평균선 데이터셋 추가 (꺾은선)
            const 요일별일평균 = 요일별노출인구데이터.요일리스트.map((요일, 인덱스) => {
                const 요일별합계 = 요일별노출인구데이터.미디어그룹리스트.reduce((합, 그룹) => 합 + 그룹.요일별데이터[인덱스], 0);
                return 요일별합계 / 요일별노출인구데이터.미디어그룹리스트.length;
            });
            
            datasets.unshift({
                label: '일평균 노출인구수',
                data: 요일별일평균,
                type: 'line',
                borderColor: '#008aff',
                borderWidth: 2,
                borderDash: [],
                fill: false,
                pointRadius: 0,
                pointHoverRadius: 0,
                tension: 0,
                order: 1
            });

            const visualizationWeeklyChart = new Chart(visualizationWeeklyCtx, {
                type: 'bar',
                data: {
                    labels: 요일별노출인구데이터.요일리스트,
                    datasets: datasets
                },
                options: {
                    indexAxis: 'x',
                    scales: {
                        x: {
                            stacked: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 12
                                },
                                color: '#616161',
                                maxRotation: 0,
                                minRotation: 0
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#757575',
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            },
                            grid: {
                                display: true,
                                color: '#e0e0e0'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.parsed.y;
                                    return label + ': ' + value.toLocaleString() + '명';
                                }
                            },
                            titleFont: {
                                family: 'Pretendard',
                                size: 12
                            },
                            bodyFont: {
                                family: 'Pretendard',
                                size: 11
                            }
                        }
                    },
                    maintainAspectRatio: false,
                    responsive: true,
                    animation: {
                        onComplete: function() {
                            const ctx = visualizationWeeklyChart.ctx;
                            
                            // 총합이 가장 높은 요일의 값을 막대 상단에 표시
                            const 최대총합요일인덱스 = 최대값인덱스;
                            const 최대총합요일막대 = visualizationWeeklyChart.getDatasetMeta(1).data[최대총합요일인덱스];
                            
                            if (최대총합요일막대) {
                                let 총누적높이 = 0;
                                for (let i = 1; i < datasets.length; i++) {
                                    const meta = visualizationWeeklyChart.getDatasetMeta(i);
                                    if (meta.data[최대총합요일인덱스]) {
                                        총누적높이 += meta.data[최대총합요일인덱스].height;
                                    }
                                }
                                
                                const x = 최대총합요일막대.x;
                                const y = 최대총합요일막대.y - 총누적높이 - 10;
                                
                                ctx.save();
                                ctx.fillStyle = '#000000';
                                ctx.font = '700 11px Pretendard';
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'bottom';
                                ctx.fillText(`총 ${최대총합값.toLocaleString()}명`, x, y);
                                ctx.restore();
                            }
                            
                            // 각 미디어그룹별 최대값 표시
                            미디어그룹별최대값.forEach((정보, index) => {
                                const meta = visualizationWeeklyChart.getDatasetMeta(index + 1);
                                
                                meta.data.forEach((bar, barIndex) => {
                                    if (barIndex === 정보.최대값인덱스) {
                                        const x = bar.x;
                                        let 누적높이 = 0;
                                        for (let i = 1; i <= index; i++) {
                                            const prevMeta = visualizationWeeklyChart.getDatasetMeta(i);
                                            누적높이 += prevMeta.data[barIndex].height;
                                        }
                                        
                                        const y = bar.y - 누적높이 - bar.height / 2;
                                        
                                        ctx.save();
                                        ctx.font = '700 11px Pretendard';
                                        const text = 정보.최대값.toLocaleString() + '명';
                                        const textMetrics = ctx.measureText(text);
                                        const textWidth = textMetrics.width;
                                        const barWidth = Math.abs(bar.width);
                                        
                                        if (textWidth < barWidth - 4) {
                                            ctx.fillStyle = '#000000';
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'middle';
                                            ctx.fillText(text, x, y);
                                        }
                                        ctx.restore();
                                    }
                                });
                            });
                        }
                    }
                }
            });
        }

        // 시간대별 노출인구 차트 (페이지 16)
        const visualizationHourlyCtx = document.getElementById('chart-canvas-mediagroup-ots-hourly');
        const visualizationHourlyMaxValueEl = document.getElementById('hourly-chart-max-value-visualization');
        const visualizationHourlyLegendEl = document.querySelector('.visualization-legend-hourly');
        
        if (visualizationHourlyCtx) {
            // 서버 측에서 템플릿 변수를 실제 데이터로 치환해야 합니다
            // 예시 구조:
            // const 시간대별노출인구데이터 = {
            //     시간대리스트: ['09시', '10시', '11시', '12시', '13시', '14시', '15시', '16시', '17시', '18시', '19시', '20시', '21시', '22시'],
            //     미디어그룹리스트: [
            //         {
            //             미디어그룹명: '{{미디어그룹명1}}',
            //             시간대별데이터: [2400, 2800, 3200, 3800, 3500, 3300, 3400, 3600, 4000, 4200, 3800, 3200, 2800, 2400],
            //             색상: 미디어그룹컬러팔레트[0]
            //         },
            //         ...
            //     ],
            //     시간대평균: 8800
            // };
            
            // 임시 데이터 (서버에서 위의 템플릿으로 치환)
            const 시간대별노출인구데이터 = {
                시간대리스트: ['09시', '10시', '11시', '12시', '13시', '14시', '15시', '16시', '17시', '18시', '19시', '20시', '21시', '22시'],
                미디어그룹리스트: [
                    {
                        미디어그룹명: '{{미디어그룹명1}}',
                        시간대별데이터: [2400, 2800, 3200, 3800, 3500, 3300, 3400, 3600, 4000, 4200, 3800, 3200, 2800, 2400],
                        색상: 미디어그룹컬러팔레트[0]
                    },
                    {
                        미디어그룹명: '{{미디어그룹명2}}',
                        시간대별데이터: [1800, 2100, 2400, 2800, 2600, 2500, 2600, 2700, 3000, 3200, 2900, 2400, 2100, 1800],
                        색상: 미디어그룹컬러팔레트[1]
                    },
                    {
                        미디어그룹명: '{{미디어그룹명3}}',
                        시간대별데이터: [2000, 2300, 2700, 3200, 3000, 2900, 3000, 3100, 3400, 3600, 3300, 2800, 2400, 2000],
                        색상: 미디어그룹컬러팔레트[2]
                    }
                ],
                시간대평균: 8800
            };

            // 각 시간대별 총합 계산
            const 시간대별총합 = 시간대별노출인구데이터.시간대리스트.map((시간대, 인덱스) => {
                return 시간대별노출인구데이터.미디어그룹리스트.reduce((합, 그룹) => 합 + 그룹.시간대별데이터[인덱스], 0);
            });

            // 총합이 가장 많은 시간대 찾기
            const 최대값인덱스 = 시간대별총합.indexOf(Math.max(...시간대별총합));
            const 최대총합값 = 시간대별총합[최대값인덱스];
            const 최대시간대 = 시간대별노출인구데이터.시간대리스트[최대값인덱스];

            // 각 미디어그룹별 최대값 찾기
            const 미디어그룹별최대값 = 시간대별노출인구데이터.미디어그룹리스트.map(그룹 => {
                const 최대값 = Math.max(...그룹.시간대별데이터);
                const 최대값인덱스 = 그룹.시간대별데이터.indexOf(최대값);
                return { 그룹, 최대값, 최대값인덱스 };
            });

            // 범례 생성
            if (visualizationHourlyLegendEl) {
                시간대별노출인구데이터.미디어그룹리스트.forEach((그룹, index) => {
                    const 색상 = 그룹.색상 || 미디어그룹컬러팔레트[index % 미디어그룹컬러팔레트.length];
                    
                    const legendItem = document.createElement('div');
                    legendItem.className = 'legend-item';
                    
                    const legendIcon = document.createElement('div');
                    legendIcon.className = 'legend-icon';
                    legendIcon.style.backgroundColor = 색상;
                    legendItem.appendChild(legendIcon);
                    
                    const legendText = document.createElement('span');
                    legendText.className = 'legend-text';
                    legendText.textContent = 그룹.미디어그룹명;
                    legendItem.appendChild(legendText);
                    
                    visualizationHourlyLegendEl.appendChild(legendItem);
                });

                // 시간대 평균 범례 추가
                const legendSeparator = document.createElement('div');
                legendSeparator.className = 'legend-separator';
                legendSeparator.innerHTML = '<svg width="20" height="1" viewBox="0 0 20 1"><line x1="0" y1="0.5" x2="20" y2="0.5" stroke="#626262" stroke-width="1"/></svg>';
                visualizationHourlyLegendEl.appendChild(legendSeparator);

                const legendItemAvg = document.createElement('div');
                legendItemAvg.className = 'legend-item';
                const legendTextAvg = document.createElement('span');
                legendTextAvg.className = 'legend-text';
                legendTextAvg.textContent = '시간대 평균 노출인구수';
                legendItemAvg.appendChild(legendTextAvg);
                visualizationHourlyLegendEl.appendChild(legendItemAvg);
            }

            // 차트 데이터셋 생성 (누적 꺾은선 그래프)
            const 누적데이터 = [];
            시간대별노출인구데이터.미디어그룹리스트.forEach((그룹, index) => {
                if (index === 0) {
                    누적데이터.push([...그룹.시간대별데이터]);
                } else {
                    const 이전누적 = 누적데이터[index - 1];
                    누적데이터.push(이전누적.map((값, i) => 값 + 그룹.시간대별데이터[i]));
                }
            });
            
            const datasets = 시간대별노출인구데이터.미디어그룹리스트.map((그룹, index) => {
                const 최대값정보 = 미디어그룹별최대값[index];
                const 색상 = 그룹.색상 || 미디어그룹컬러팔레트[index % 미디어그룹컬러팔레트.length];
                return {
                    label: 그룹.미디어그룹명,
                    data: 누적데이터[index],
                    backgroundColor: 색상 + '80',
                    borderColor: 색상,
                    borderWidth: 2,
                    fill: index === 0 ? true : '-1',
                    tension: 0.4,
                    maxValue: 최대값정보.최대값,
                    maxValueIndex: 최대값정보.최대값인덱스
                };
            });

            // 시간대 평균선 데이터셋 추가 (보조선)
            datasets.push({
                label: '시간대 평균 노출인구수',
                data: Array(시간대별노출인구데이터.시간대리스트.length).fill(시간대별노출인구데이터.시간대평균),
                type: 'line',
                borderColor: '#008aff',
                borderWidth: 2,
                borderDash: [5, 5],
                fill: false,
                pointRadius: 0,
                pointHoverRadius: 0,
                tension: 0,
                order: 0
            });

            const visualizationHourlyChart = new Chart(visualizationHourlyCtx, {
                type: 'line',
                data: {
                    labels: 시간대별노출인구데이터.시간대리스트,
                    datasets: datasets
                },
                options: {
                    indexAxis: 'x',
                    scales: {
                        x: {
                            stacked: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#616161',
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            stacked: false,
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Pretendard',
                                    size: 10
                                },
                                color: '#757575',
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            },
                            grid: {
                                display: true,
                                color: '#e0e0e0'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.parsed.y;
                                    return label + ': ' + value.toLocaleString() + '명';
                                }
                            },
                            titleFont: {
                                family: 'Pretendard',
                                size: 12
                            },
                            bodyFont: {
                                family: 'Pretendard',
                                size: 11
                            }
                        }
                    },
                    maintainAspectRatio: false,
                    responsive: true,
                    animation: {
                        onComplete: function() {
                            const ctx = visualizationHourlyChart.ctx;
                            
                            // 각 미디어그룹별 최대값에 라벨 표시
                            미디어그룹별최대값.forEach((정보, index) => {
                                const meta = visualizationHourlyChart.getDatasetMeta(index);
                                if (meta && meta.data && meta.data[정보.최대값인덱스]) {
                                    const point = meta.data[정보.최대값인덱스];
                                    const x = point.x;
                                    let 누적높이 = 0;
                                    for (let i = 0; i < index; i++) {
                                        const prevMeta = visualizationHourlyChart.getDatasetMeta(i);
                                        if (prevMeta && prevMeta.data && prevMeta.data[정보.최대값인덱스]) {
                                            const prevPoint = prevMeta.data[정보.최대값인덱스];
                                            누적높이 += prevPoint.y;
                                        }
                                    }
                                    const y = point.y - 누적높이;
                                    
                                    ctx.save();
                                    ctx.fillStyle = '#000000';
                                    ctx.font = '400 11px Pretendard';
                                    ctx.textAlign = 'center';
                                    ctx.textBaseline = 'bottom';
                                    ctx.fillText(정보.최대값.toLocaleString() + '명', x, y - 5);
                                    ctx.restore();
                                }
                            });
                            
                            // 누적 합계가 가장 높은 시간대 강조
                            const maxTotalMeta = visualizationHourlyChart.getDatasetMeta(시간대별노출인구데이터.미디어그룹리스트.length - 1);
                            if (maxTotalMeta && maxTotalMeta.data && maxTotalMeta.data[최대값인덱스]) {
                                const maxPoint = maxTotalMeta.data[최대값인덱스];
                                const x = maxPoint.x;
                                const y = maxPoint.y;
                                
                                ctx.save();
                                ctx.fillStyle = 'rgba(182, 167, 255, 0.5)';
                                ctx.strokeStyle = '#6f47ff';
                                ctx.lineWidth = 1;
                                ctx.fillRect(x - 38, 0, 76, y);
                                ctx.strokeRect(x - 38, 0, 76, y);
                                ctx.restore();
                            }
                        }
                    }
                }
            });
        }
    </script>
    </div> <!-- page-wrapper 닫기 -->
</body>
</html>


